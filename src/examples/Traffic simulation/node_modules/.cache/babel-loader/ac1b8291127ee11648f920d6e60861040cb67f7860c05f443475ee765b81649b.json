{"ast":null,"code":"import { debounce, observerDomResize } from '../util/index';\nexport default {\n  data() {\n    return {\n      dom: '',\n      width: 0,\n      height: 0,\n      debounceInitWHFun: '',\n      domObserver: ''\n    };\n  },\n  methods: {\n    async autoResizeMixinInit() {\n      const {\n        initWH,\n        getDebounceInitWHFun,\n        bindDomResizeCallback,\n        afterAutoResizeMixinInit\n      } = this;\n      await initWH(false);\n      getDebounceInitWHFun();\n      bindDomResizeCallback();\n      if (typeof afterAutoResizeMixinInit === 'function') afterAutoResizeMixinInit();\n    },\n    initWH(resize = true) {\n      const {\n        $nextTick,\n        $refs,\n        ref,\n        onResize\n      } = this;\n      return new Promise(resolve => {\n        $nextTick(_ => {\n          const dom = this.dom = $refs[ref];\n          this.width = dom ? dom.clientWidth : 0;\n          this.height = dom ? dom.clientHeight : 0;\n          if (!dom) {\n            console.warn('DataV: Failed to get dom node, component rendering may be abnormal!');\n          } else if (!this.width || !this.height) {\n            console.warn('DataV: Component width or height is 0px, rendering abnormality may occur!');\n          }\n          if (typeof onResize === 'function' && resize) onResize();\n          resolve();\n        });\n      });\n    },\n    getDebounceInitWHFun() {\n      const {\n        initWH\n      } = this;\n      this.debounceInitWHFun = debounce(100, initWH);\n    },\n    bindDomResizeCallback() {\n      const {\n        dom,\n        debounceInitWHFun\n      } = this;\n      this.domObserver = observerDomResize(dom, debounceInitWHFun);\n      window.addEventListener('resize', debounceInitWHFun);\n    },\n    unbindDomResizeCallback() {\n      let {\n        domObserver,\n        debounceInitWHFun\n      } = this;\n      if (!domObserver) return;\n      domObserver.disconnect();\n      domObserver.takeRecords();\n      domObserver = null;\n      window.removeEventListener('resize', debounceInitWHFun);\n    }\n  },\n  mounted() {\n    const {\n      autoResizeMixinInit\n    } = this;\n    autoResizeMixinInit();\n  },\n  beforeDestroy() {\n    const {\n      unbindDomResizeCallback\n    } = this;\n    unbindDomResizeCallback();\n  }\n};","map":{"version":3,"names":["debounce","observerDomResize","data","dom","width","height","debounceInitWHFun","domObserver","methods","autoResizeMixinInit","initWH","getDebounceInitWHFun","bindDomResizeCallback","afterAutoResizeMixinInit","resize","$nextTick","$refs","ref","onResize","Promise","resolve","_","clientWidth","clientHeight","console","warn","window","addEventListener","unbindDomResizeCallback","disconnect","takeRecords","removeEventListener","mounted","beforeDestroy"],"sources":["D:/doc/workplace/vscode/Traffic simulation/node_modules/@jiaminghi/data-view/lib/mixin/autoResize.js"],"sourcesContent":["import { debounce, observerDomResize } from '../util/index'\n\nexport default {\n  data () {\n    return {\n      dom: '',\n\n      width: 0,\n      height: 0,\n\n      debounceInitWHFun: '',\n\n      domObserver: ''\n    }\n  },\n  methods: {\n    async autoResizeMixinInit () {\n      const { initWH, getDebounceInitWHFun, bindDomResizeCallback, afterAutoResizeMixinInit } = this\n\n      await initWH(false)\n\n      getDebounceInitWHFun()\n\n      bindDomResizeCallback()\n\n      if (typeof afterAutoResizeMixinInit === 'function') afterAutoResizeMixinInit()\n    },\n    initWH (resize = true) {\n      const { $nextTick, $refs, ref, onResize } = this\n\n      return new Promise(resolve => {\n        $nextTick(_ => {\n          const dom = this.dom = $refs[ref]\n\n          this.width = dom ? dom.clientWidth : 0\n          this.height = dom ? dom.clientHeight : 0\n\n          if (!dom) {\n            console.warn('DataV: Failed to get dom node, component rendering may be abnormal!')\n          } else if (!this.width || !this.height) {\n            console.warn('DataV: Component width or height is 0px, rendering abnormality may occur!')\n          }\n\n          if (typeof onResize === 'function' && resize) onResize()\n\n          resolve()\n        })\n      })\n    },\n    getDebounceInitWHFun () {\n      const { initWH } = this\n\n      this.debounceInitWHFun = debounce(100, initWH)\n    },\n    bindDomResizeCallback () {\n      const { dom, debounceInitWHFun } = this\n\n      this.domObserver = observerDomResize(dom, debounceInitWHFun)\n\n      window.addEventListener('resize', debounceInitWHFun)\n    },\n    unbindDomResizeCallback () {\n      let { domObserver, debounceInitWHFun } = this\n\n      if (!domObserver) return\n\n      domObserver.disconnect()\n      domObserver.takeRecords()\n      domObserver = null\n\n      window.removeEventListener('resize', debounceInitWHFun)\n    }\n  },\n  mounted () {\n    const { autoResizeMixinInit } = this\n\n    autoResizeMixinInit()\n  },\n  beforeDestroy () {\n    const { unbindDomResizeCallback } = this\n\n    unbindDomResizeCallback()\n  }\n}\n"],"mappings":"AAAA,SAASA,QAAQ,EAAEC,iBAAiB,QAAQ,eAAe;AAE3D,eAAe;EACbC,IAAIA,CAAA,EAAI;IACN,OAAO;MACLC,GAAG,EAAE,EAAE;MAEPC,KAAK,EAAE,CAAC;MACRC,MAAM,EAAE,CAAC;MAETC,iBAAiB,EAAE,EAAE;MAErBC,WAAW,EAAE;IACf,CAAC;EACH,CAAC;EACDC,OAAO,EAAE;IACP,MAAMC,mBAAmBA,CAAA,EAAI;MAC3B,MAAM;QAAEC,MAAM;QAAEC,oBAAoB;QAAEC,qBAAqB;QAAEC;MAAyB,CAAC,GAAG,IAAI;MAE9F,MAAMH,MAAM,CAAC,KAAK,CAAC;MAEnBC,oBAAoB,CAAC,CAAC;MAEtBC,qBAAqB,CAAC,CAAC;MAEvB,IAAI,OAAOC,wBAAwB,KAAK,UAAU,EAAEA,wBAAwB,CAAC,CAAC;IAChF,CAAC;IACDH,MAAMA,CAAEI,MAAM,GAAG,IAAI,EAAE;MACrB,MAAM;QAAEC,SAAS;QAAEC,KAAK;QAAEC,GAAG;QAAEC;MAAS,CAAC,GAAG,IAAI;MAEhD,OAAO,IAAIC,OAAO,CAACC,OAAO,IAAI;QAC5BL,SAAS,CAACM,CAAC,IAAI;UACb,MAAMlB,GAAG,GAAG,IAAI,CAACA,GAAG,GAAGa,KAAK,CAACC,GAAG,CAAC;UAEjC,IAAI,CAACb,KAAK,GAAGD,GAAG,GAAGA,GAAG,CAACmB,WAAW,GAAG,CAAC;UACtC,IAAI,CAACjB,MAAM,GAAGF,GAAG,GAAGA,GAAG,CAACoB,YAAY,GAAG,CAAC;UAExC,IAAI,CAACpB,GAAG,EAAE;YACRqB,OAAO,CAACC,IAAI,CAAC,qEAAqE,CAAC;UACrF,CAAC,MAAM,IAAI,CAAC,IAAI,CAACrB,KAAK,IAAI,CAAC,IAAI,CAACC,MAAM,EAAE;YACtCmB,OAAO,CAACC,IAAI,CAAC,2EAA2E,CAAC;UAC3F;UAEA,IAAI,OAAOP,QAAQ,KAAK,UAAU,IAAIJ,MAAM,EAAEI,QAAQ,CAAC,CAAC;UAExDE,OAAO,CAAC,CAAC;QACX,CAAC,CAAC;MACJ,CAAC,CAAC;IACJ,CAAC;IACDT,oBAAoBA,CAAA,EAAI;MACtB,MAAM;QAAED;MAAO,CAAC,GAAG,IAAI;MAEvB,IAAI,CAACJ,iBAAiB,GAAGN,QAAQ,CAAC,GAAG,EAAEU,MAAM,CAAC;IAChD,CAAC;IACDE,qBAAqBA,CAAA,EAAI;MACvB,MAAM;QAAET,GAAG;QAAEG;MAAkB,CAAC,GAAG,IAAI;MAEvC,IAAI,CAACC,WAAW,GAAGN,iBAAiB,CAACE,GAAG,EAAEG,iBAAiB,CAAC;MAE5DoB,MAAM,CAACC,gBAAgB,CAAC,QAAQ,EAAErB,iBAAiB,CAAC;IACtD,CAAC;IACDsB,uBAAuBA,CAAA,EAAI;MACzB,IAAI;QAAErB,WAAW;QAAED;MAAkB,CAAC,GAAG,IAAI;MAE7C,IAAI,CAACC,WAAW,EAAE;MAElBA,WAAW,CAACsB,UAAU,CAAC,CAAC;MACxBtB,WAAW,CAACuB,WAAW,CAAC,CAAC;MACzBvB,WAAW,GAAG,IAAI;MAElBmB,MAAM,CAACK,mBAAmB,CAAC,QAAQ,EAAEzB,iBAAiB,CAAC;IACzD;EACF,CAAC;EACD0B,OAAOA,CAAA,EAAI;IACT,MAAM;MAAEvB;IAAoB,CAAC,GAAG,IAAI;IAEpCA,mBAAmB,CAAC,CAAC;EACvB,CAAC;EACDwB,aAAaA,CAAA,EAAI;IACf,MAAM;MAAEL;IAAwB,CAAC,GAAG,IAAI;IAExCA,uBAAuB,CAAC,CAAC;EAC3B;AACF,CAAC","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}
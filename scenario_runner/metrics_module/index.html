<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
      <link rel="shortcut icon" href="../../img/favicon.ico" />
    <title>指标模块 - 交通仿真文档</title>
    <link rel="stylesheet" href="../../css/theme.css" />
    <link rel="stylesheet" href="../../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" />
        <link href="../../extra.css" rel="stylesheet" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "\u6307\u6807\u6a21\u5757";
        var mkdocs_page_input_path = "scenario_runner\\metrics_module.md";
        var mkdocs_page_url = null;
      </script>
    
    <!--[if lt IE 9]>
      <script src="../../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
      <script>hljs.highlightAll();</script> 
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href="../.." class="icon icon-home"> 交通仿真文档
        </a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../..">主页</a>
                </li>
              </ul>
              <p class="caption"><span class="caption-text">入门</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../start_introduction/">介绍</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../start_quickstart/">快速启动包安装</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../tuto_first_steps/">第一步</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../tutorials/">教程</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">构建 Carla</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../build_carla/">构建 Carla</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../build_linux/">Linux 上编译</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../build_windows/">Windows 上编译</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../build_update/">Carla 更新</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../build_system/">编译系统</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../build_docker/">Docker 中的 Carla</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../build_faq/">常问的问题</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Carla 主题</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../foundations/">概念和基础</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../core_world/">第一、世界和客户端</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../core_actors/">第二、参与者和蓝图</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../core_map/">第三、地图和导航 </a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../core_sensors/">第四、传感器和数据</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../development_tutorials/">开发</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../custom_assets_tutorials/">自定义资产</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../tuto_content_authoring_maps/">内容创作 - 地图</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../tuto_content_authoring_vehicles/">内容创作 - 车辆</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">交通仿真</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../ts_traffic_simulation_overview/">交通</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../adv_traffic_manager/">交通管理器</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../adv_sumo/">和 SUMO 联合仿真</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../tuto_G_scenic/">Scenic</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">行人</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../tuto_G_pedestrian_bones/">行人骨骼</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../tuto_G_control_walker_skeletons/">控制行人骨骼</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../tuto_G_pedestrian_visual/">行人视觉</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../tuto_M_generate_pedestrian_navigation/">生成行人导航</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">高级概念</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../adv_opendrive/">OpenDRIVE 独立模式</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../adv_recorder/">记录器</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../adv_rendering_options/">渲染选项</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../adv_rss/">责任敏感安全</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../adv_synchrony_timestep/">同步和时间步长</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../adv_benchmarking/">基准性能</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../adv_agents/">Carla 智能体</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">资源</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../python_api/">Python API 参考</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../ref_cpp/">C++ 参考</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../bp_library/">蓝图库</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../catalogue/">Carla 目录</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../ref_recorder_binary_file_format/">记录器二进制文件格式</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../ref_sensors/">传感器参考</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../ext_docs/">扩展文档</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">自定义地图</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../tuto_M_custom_map_overview/">Carla 中自定义地图的概述</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../tuto_M_generate_map/">在 RoadRunner 中创建地图</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../tuto_M_add_map_package/">在 Carla 包导入地图</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../tuto_M_add_map_source/">在 Carla 源构建中导入地图</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../tuto_M_add_map_alternative/">导入地图的替代方法</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../tuto_M_manual_map_package/">手动准备地图包</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../tuto_M_custom_layers/">自定义地图：分层地图</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../tuto_M_custom_add_tl/">自定义地图：红绿灯和标志</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../tuto_M_custom_road_painter/">自定义地图：道路画家</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../tuto_M_custom_weather_landscape/">自定义地图：天气和景观</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../tuto_G_openstreetmap/">使用 OpenStreetMap 生成地图</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../tuto_M_custom_buildings/">自定义地图：程序建筑</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../adv_digital_twin/">数字孪生工具</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">大地图</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../large_map_overview/">大地图概述</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../large_map_roadrunner/">在RoadRunner中创建大地图</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../large_map_import/">导入/打包大地图</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">教程（通用）</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../tuto_G_add_friction_triggers/">添加摩擦触发器</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../tuto_G_control_vehicle_physics/">控制车辆物理模型</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../tuto_G_retrieve_data/">检索仿真数据</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../build_docker_unreal/">在 Docker 中构建虚幻引擎和 Carla</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">教程（资产）</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../tuto_A_add_vehicle/">添加新车辆</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../tuto_A_add_props/">添加新道具</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../tuto_A_create_standalone/">创建独立包</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../tuto_A_material_customization/">材质定制</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">教程（开发人员）</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../tuto_D_contribute_assets/">如何升级内容</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../tuto_D_create_sensor/">创建一个传感器</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../tuto_D_create_semantic_tags/">创建语义标签</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../tuto_D_customize_vehicle_suspension/">自定义车辆悬架</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../tuto_D_generate_colliders/">生成详细碰撞</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../tuto_D_make_release/">发布版本</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../tuto_D_windows_debug/">调试程序</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">示例</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../tuto_E_gallery/">入门</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../tuto_G_traffic_light/">交通灯的配置和使用</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../tuto_G_traffic_prediction/">流量预测</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Carla 生态系统</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../ecosys_iss/">ISS 智能驾驶系统</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../plugins_carlaviz/">Web 可视化器</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../ros_documentation/">ROS</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../ecosys_femfx/">有限元变形材料虚幻插件</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../tuto_G_carsim_integration/">CarSim 集成</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../tuto_G_rllib_integration/">RLlib 集成</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../tuto_G_chrono/">Chrono 集成</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../OpenRadioss/use_OpenRadioss_windows/">OpenRadios 有限元仿真</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../adv_ptv/">PTV-Vissim 联合仿真</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../ecosys_ansys/">Ansys 实时雷达模型</a>
                  </li>
                  <li class="toctree-l1"><a class="" href="https://github.com/darkscyla/MATLAB-Carla-Interface">Matlab 接口</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../tuto_G_G29_windows/">罗技 G29 方向盘</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">贡献</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../cont_contribution_guidelines/">贡献指南</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../cont_code_of_conduct/">行为准则</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../cont_coding_standard/">编码标准</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../cont_doc_standard/">文档标准</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">其他</span></p>
              <ul>
                  <li class="toctree-l1"><a class="" href="https://ww2.mathworks.cn/help/roadrunner/index.html">RoadRunner</a>
                  </li>
                  <li class="toctree-l1"><a class="" href="https://ww2.mathworks.cn/help/roadrunner-scenario/index.html">RoadRunner Scenario</a>
                  </li>
                  <li class="toctree-l1"><a class="" href="https://bbs.carla.org.cn/">Carla 中文站</a>
                  </li>
                  <li class="toctree-l1"><a class="" href="https://github.com/OpenHUTB/engine_doc">虚幻引擎教程</a>
                  </li>
                  <li class="toctree-l1"><a class="" href="https://docs.blender.org/manual/zh-hans/latest/">Blender 手册</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../file_specification/">文件说明</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../todo/">待做列表</a>
                  </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../..">交通仿真文档</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../.." class="icon icon-home" aria-label="Docs"></a></li>
      <li class="breadcrumb-item active">指标模块</li>
    <li class="wy-breadcrumbs-aside">
          <a href="edit/main/docs/scenario_runner/metrics_module.md">Edit</a>
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <h1 id="_1">指标模块</h1>
<p>指标模块依靠 <a href="https://carla.readthedocs.io/en/latest/adv_recorder/">CARLA 记录器</a> 来方便计算和监控任何类型的参数。场景完成后，记录器存储模拟信息。然后，用户可以定义自己的指标，并检查相应的结果，而无需一次又一次地进行仿真。</p>
<p>本节介绍了构成该模块的不同元素的说明、如何创建新指标的分步教程以及查询记录和定义指标的函数的参考。</p>
<ul>
<li><a href="#structure-of-the-module"><strong>模块结构</strong></a>  </li>
<li><a href="#how-to-use-the-metrics-module"><strong>如何使用指标模块</strong></a>  <ul>
<li><a href="#1.-record-a-scenario">1. 记录一个场景</a>  </li>
<li><a href="#2.-run-the-metrics-manager">2. 定义指标</a>  </li>
<li><a href="#3.-run-the-metrics-manager">3. 运行指标管理器</a>  </li>
</ul>
</li>
<li><a href="#recording-queries-reference"><strong>记录查询参考</strong></a>  <ul>
<li><a href="#generic-actor-data">通用参与者数据</a>  </li>
<li><a href="#generic-simulation-data">通用仿真数据</a>  </li>
<li><a href="#actor-accelerations">参与者加速度</a>  </li>
<li><a href="#actor-angular-velocities">参与者角速度</a>  </li>
<li><a href="#actor-controls">参与者控制</a>  </li>
<li><a href="#actor-transforms">参与者变换</a>  </li>
<li><a href="#actor-velocities">参与者速度</a>  </li>
<li><a href="#scene-lights">场景灯</a>  </li>
<li><a href="#traffic-lights">红绿灯</a>  </li>
<li><a href="#vehicle-lights">车灯</a>  </li>
</ul>
</li>
</ul>
<hr />
<h2 id="_2">模块结构</h2>
<p>与主 ScenarioRunner 模块类似，Metrics 模块使用主脚本 运行，<code>metrics_manager.py</code>其余信息包含在文件夹结构内。这里简单介绍一下主要脚本。</p>
<ul>
<li><strong><code>metrics_manager.py</code></strong> — 模块的主脚本。运行此命令以显示一组指标的结果。该脚本具有常用的<code>host</code>和<code>port</code>参数，以及更多用于设置要使用的指标和记录的内容。<ul>
<li><code>host</code> <em>(string)</em> – CARLA 仿真运行时的 IP 地址。默认为<code>(127.0.0.1)</code>。</li>
<li><code>port</code> <em>(int)</em> – CARLA 仿真运行的 TCP 端口。默认为<code>2000</code>和<code>2001</code>。 </li>
<li><code>metrics</code> — 要使用的指标的路径。 </li>
<li><code>log</code> — 包含记录的<code>.log</code>文件的路径（相对于环境变量<code>SCENARIO_RUNNER_ROOT</code>）。</li>
<li><code>criteria</code> <em>(可选)</em> — 具有场景条件的 JSON 文件的路径。</li>
</ul>
</li>
</ul>
<p>塑造模块的其余元素可以在该<code>srunner/metrics</code>文件夹中找到。这些文件夹已分为三个子文件夹。</p>
<ul>
<li>
<p><strong><code>srunner/metrics/data</code></strong> — 存储有关场景的信息。默认情况下，它有六个文件，它们是示例指标的一部分。</p>
</li>
<li>
<p><strong><code>srunner/metrics/examples</code></strong> — 包含一些示例指标，以及包含用于创建新指标的基类<code>BaseMetric</code>的指标。  </p>
<ul>
<li><code>basic_metric.py</code> – 包含基类<code>BaseMetric</code>。所有的指标都是从它继承的。 </li>
<li><code>criteria_filter.py</code> – 返回包含标准最重要属性的 JSON。</li>
<li><code>distance_between_vehicles.py</code> – 返回两辆车之间的距离。有助于展示如何查询记录。</li>
<li><code>distance_to_lane_center.py</code> – 计算车辆位置与车道中心之间的距离。有助于展示如何访问地图 API 信息。</li>
</ul>
</li>
<li>
<p><strong><code>srunner/metrics/tools</code></strong> — 包含两个允许查询记录的关键脚本。</p>
<ul>
<li><code>metrics_parser.py</code> – 将记录提供的字符串转换为字典。</li>
<li><code>metrics_log.py</code> – 提供多种功能来查询使用<code>metrics_parser.py</code>创建的字典。这些函数是访问场景信息的最简单方法。它们列在本页最后一段的 <a href="#recording-queries-reference">参考文献</a> 中。  </li>
</ul>
</li>
</ul>
<hr />
<h2 id="_3">如何使用指标模块</h2>
<h3 id="1">1. 记录一个场景</h3>
<p>指标模块需要记录仿真才能工作。否则，它没有数据来进行指标计算。</p>
<p>使用<code>record</code> 参数。添加应该保存信息的路径。该路径必须相对于环境变量<code>SCENARIO_RUNNER_ROOT</code>。</p>
<pre><code class="language-sh">python scenario_runner.py --scenario &lt;scenario_name&gt; --record &lt;path/to/save/the/recorder/file&gt;
</code></pre>
<p>通过记录场景，将在所需路径中创建两个文件。这些<code>log</code>文件<code>criteria</code>稍后将用作<code>metrics_manager.py</code>的参数。
<strong>1. CARLA 记录</strong> <em>(<code>.log</code>)</em> — 包含每帧的仿真数据。要了解更多信息，请阅读 <a href="https://carla.readthedocs.io/en/latest/adv_recorder/">记录器文档</a> 。 
<strong>2. 指标文件</strong> <em>(.json)</em> — 场景标准解析为字典，并存储在 JSON 文件中。字典的键是条件的名称。这些值是每个条件的属性。</p>
<div class="admonition 注意">
<p class="admonition-title">注意</p>
<p>仅解析 JSON 可序列化属性，其余属性将被忽略。</p>
</div>
<p>默认情况下，这两个文件均以运行的场景命名。如果场景被命名为<code>example.py</code>，文件将为<code>example.log</code>和<code>example.json</code>。 </p>
<h3 id="2">2. 定义指标</h3>
<p>现在是创建将用于场景的所需指标的时候了。可能性是无限的，但为了本教程的目的，将使用<code>srunner/metrics/examples/distance_between_vehicles.py</code>中描述的指标作为示例。让我们深入研究一下代码本身。</p>
<pre><code>class DistanceBetweenVehicles(BasicMetric):
"""
指标类 DistanceBetweenVehicles
"""

def _create_metric(self, town_map, log, criteria):
    """
    度量的实现。这是一个示例，展示了如何使用通过日志访问的记录器。
    """

    # 获取两辆车的ID
    ego_id = log.get_ego_vehicle_id()
    adv_id = log.get_actor_ids_with_role_name("scenario")[0]  # Could have also used its type_id

    dist_list = []
    frames_list = []

    # 获得帧的参与者都活着
    start_ego, end_ego = log.get_actor_alive_frames(ego_id)
    start_adv, end_adv = log.get_actor_alive_frames(adv_id)
    start = max(start_ego, start_adv)
    end = min(end_ego, end_adv)

    # 获得两者之间的距离
    for i in range(start, end):

        # 获得变换
        ego_location = log.get_actor_transform(ego_id, i).location
        adv_location = log.get_actor_transform(adv_id, i).location

        # 过滤一些点以获得更好的图形
        if adv_location.z &lt; -10:
            continue

        dist_v = ego_location - adv_location
        dist = math.sqrt(dist_v.x * dist_v.x + dist_v.y * dist_v.y + dist_v.z * dist_v.z)

        dist_list.append(dist)
        frames_list.append(i)

    # 使用 matplotlib 展示结果
    plt.plot(frames_list, dist_list)
    plt.ylabel('Distance [m]')
    plt.xlabel('Frame number')
    plt.title('Distance between the ego vehicle and the adversary over time')
    plt.show()
</code></pre>
<p><strong>2.1. 度量的名称</strong>. 首先，正如前面提到的，所有指标都是该<code>BasicMetric</code>类的子级。 </p>
<pre><code class="language-py">    class DistanceBetweenVehicles(BasicMetric):
</code></pre>
<p><strong>2.2. 主方法的名称</strong>. 指标只需要一种方法即可运行，<code>_create_metric()</code>方法具有三个参数。</p>
<ul>
<li><strong><code>town_map</code></strong> — 场景发生的<a href="https://carla.readthedocs.io/en/latest/python_api/#carlamap">carla.Map()</a>实例。</li>
<li><strong><code>log</code></strong> — <code>MetricsLog</code>类的实例，具有访问记录器字典所需的所有函数。 </li>
<li><strong><code>criteria</code></strong> — 带有标准字典的 JSOn。记录场景时提供的文件，稍后提供给<code>metrics_manager.py</code>。</li>
</ul>
<pre><code class="language-py">def _create_metric(self, town_map, log, criteria):
</code></pre>
<p><strong>2.3. 实现指标</strong>。 代码将根据指标本身而有所不同。</p>
<p>示例指标<code>DistanceBetweenVehicles</code>计算本车与其跟随的汽车（对手）之间的距离。为此，需要<code>id</code>两辆车的配合。这些可以使用<code>get_ego_vehicle_id()</code>和<code>get_actor_ids_with_role_name("scenario")[0]</code>函数从日志中检索。</p>
<pre><code class="language-py"># 获取两个车辆的 ID 
ego_id = log.get_ego_vehicle_id()
adv_id = log.get_actor_ids_with_role_name(&quot;scenario&quot;)[0]  # Could have also used its type_id
</code></pre>
<p>它们<code>id</code>用<code>get_actor_alive_frames(actor_id)</code>检索车辆处于活动状态的帧。</p>
<pre><code class="language-py"># 获取活跃的两个参与者的帧
start_ego, end_ego = log.get_actor_alive_frames(ego_id)
start_adv, end_adv = log.get_actor_alive_frames(adv_id)
start = max(start_ego, start_adv)
end = min(end_ego, end_adv)
</code></pre>
<p>现在一切准备就绪，可以循环这些帧，获取它们的变换并计算距离。使用<code>get_actor_transform(actor_id, frame)</code> 获得变换，</p>
<pre><code class="language-py">dist_list = []
frames_list = []

...

# 获得两者之间的距离
for i in range(start, end):

    # 获取变换
    ego_location = log.get_actor_transform(ego_id, i).location
    adv_location = log.get_actor_transform(adv_id, i).location

    # 为了获得更好的图片过滤一些点
    if adv_location.z &lt; -10:
        continue

    dist_v = ego_location - adv_location
    dist = math.sqrt(dist_v.x * dist_v.x + dist_v.y * dist_v.y + dist_v.z * dist_v.z)

    dist_list.append(dist)
</code></pre>
<div class="admonition 注意">
<p class="admonition-title">注意</p>
<p>对手的垂直情况仅考虑对手正常行驶时的情况。</p>
</div>
<p>最后，使用 <a href="https://matplotlib.org/">matplotlib</a> 定义运行 <code>metrics_manager.py</code> 时指标的输出。 </p>
<pre><code class="language-py"># 使用 matplotlib 展示结果
plt.plot(frames_list, dist_list)
plt.ylabel('Distance [m]')
plt.xlabel('Frame number')
plt.title('Distance between the ego vehicle and the adversary over time')
plt.show()
</code></pre>
<h3 id="3">3. 运行指标管理器</h3>
<p>最后，是时候使用从场景中检索的信息以及已定义的指标来返回一些指标信息。让我们使用迄今为止使用的示例指标以及以其命名的示例日志来运行该模块。 </p>
<pre><code class="language-sh">python metrics_manager.py --metric srunner/metrics/examples/distance_between_vehicles.py --log srunner/metrics/data/DistanceBetweenVehicles.log
</code></pre>
<div class="admonition 警告">
<p class="admonition-title">警告</p>
<p>仿真必须正在运行。否则，模块将无法访问地图API。</p>
</div>
<p>这将创建一个新窗口，其中绘制了结果。在输出窗口关闭之前，脚本不会完成。</p>
<p><img alt="metrics_plot" src="../img/metrics_example.jpg" /></p>
<hr />
<h2 id="_4">记录查询参考</h2>
<p>定义指标时，有关场景的所有信息都通过类<code>MetricsLog</code>（<code>_create_metric()</code>函数中的<code>log</code>参数）访问。该类位于<code>srunner/metrics/tools/metrics_log.py</code>，该引用是其中包含的函数的后续部分。</p>
<h3 id="_5">通用参与者数据</h3>
<ul>
<li>
<p><a name="get_ego_vehicle_id"></a><strong><font color="#7fb800">get_ego_vehicle_id</font></strong>(<font color="#00a6ed"><strong>self</strong></font>)<br />
返回自我车辆的 <code>id</code>。</p>
<ul>
<li><strong>Return —</strong> int</li>
</ul>
</li>
<li>
<p><a name="get_actor_ids_with_role_name"></a><strong><font color="#7fb800">get_actor_ids_with_role_name</font></strong>(<font color="#00a6ed"><strong>self</strong></font>, <font color="#00a6ed"><strong>role_name</strong></font>)<br />
返回与给定<code>role_name</code>匹配的参与者<code>id</code>列表。</p>
<ul>
<li><strong>Return —</strong> list</li>
<li><strong>Parameters</strong><ul>
<li><code>role_name</code> (<em>str</em>) — 参与者的<code>role_name</code>。</li>
</ul>
</li>
</ul>
</li>
<li>
<p><a name="get_actor_ids_with_type_id"></a><strong><font color="#7fb800">get_actor_ids_with_type_id</font></strong>(<font color="#00a6ed"><strong>self</strong></font>, <font color="#00a6ed"><strong>type_id</strong></font>)<br />
根据 fnmatch 标准，返回与给定匹配的参与者 <code>id</code> 列表。</p>
<ul>
<li><strong>Return —</strong> list</li>
<li><strong>Parameters</strong><ul>
<li><code>type_id</code> (<em>str</em>) — 参与者<code>type_id</code>。</li>
</ul>
</li>
</ul>
</li>
<li>
<p><a name="get_actor_attributes"></a><strong><font color="#7fb800">get_actor_attributes</font></strong>(<font color="#00a6ed"><strong>self</strong></font>, <font color="#00a6ed"><strong>actor_id</strong></font>)<br />
返回包含参与者所有属性的字典。</p>
<ul>
<li><strong>Return —</strong> dict</li>
<li><strong>Parameters</strong><ul>
<li><code>actor_id</code> (<em>int</em>) — 参与者的<code>id</code>。</li>
</ul>
</li>
</ul>
</li>
<li>
<p><a name="get_actor_bounding_box"></a><strong><font color="#7fb800">get_actor_bounding_box</font></strong>(<font color="#00a6ed"><strong>self</strong></font>, <font color="#00a6ed"><strong>actor_id</strong></font>)<br />
返回指定参与者的边界框。</p>
<ul>
<li><strong>Return —</strong> <a href="https://carla.readthedocs.io/en/latest/python_api/#carlaboundingbox">carla.BoundingBox</a></li>
<li><strong>Parameters</strong><ul>
<li><code>actor_id</code> (<em>int</em>) — 参与者的<code>id</code>。</li>
</ul>
</li>
</ul>
</li>
<li>
<p><a name="get_traffic_light_trigger_volume"></a><strong><font color="#7fb800">get_traffic_light_trigger_volume</font></strong>(<font color="#00a6ed"><strong>self</strong></font>, <font color="#00a6ed"><strong>traffic_light_id</strong></font>)<br />
返回指定交通灯的 trigger volume。</p>
<ul>
<li><strong>Return —</strong> <a href="https://carla.readthedocs.io/en/latest/python_api/#carlaboundingbox">carla.BoundingBox</a></li>
<li><strong>Parameters</strong><ul>
<li><code>traffic_light_id</code> (<em>int</em>) — 红绿灯的<code>id</code>。</li>
</ul>
</li>
</ul>
</li>
<li>
<p><a name="get_actor_alive_frames"></a><strong><font color="#7fb800">get_actor_alive_frames</font></strong>(<font color="#00a6ed"><strong>self</strong></font>, <font color="#00a6ed"><strong>actor_id</strong></font>)<br />
返回一个元组，其中包含参与者活跃的第一帧和最后一帧。请注意，帧从 1 开始，而不是从 0 开始。</p>
<ul>
<li><strong>Return —</strong> tuple</li>
<li><strong>Parameters</strong><ul>
<li><code>actor_id</code> (<em>int</em>) — 参与者的<code>id</code>。</li>
</ul>
</li>
</ul>
</li>
</ul>
<h3 id="_6">通用仿真数据</h3>
<ul>
<li>
<p><a name="get_collisions"></a><strong><font color="#7fb800">get_collisions</font></strong>(<font color="#00a6ed"><strong>self</strong></font>,<font color="#00a6ed"><strong>actor_id</strong></font>)<br />
返回具有两个键的字典列表。<code>frame</code>是碰撞的帧编号， 是<code>other_id</code> 参与者在该帧发生碰撞的 id 列表。</p>
<ul>
<li><strong>Return —</strong> list</li>
<li><strong>Parameters</strong><ul>
<li><code>actor_id</code> (<em>int</em>) — 参与者的<code>id</code>。</li>
</ul>
</li>
</ul>
</li>
<li>
<p><a name="get_total_frame_count"></a><strong><font color="#7fb800">get_total_frame_count</font></strong>(<font color="#00a6ed"><strong>self</strong></font>)<br />
返回一个 int 值，其中包含仿真持续的帧总数。</p>
<ul>
<li><strong>Return —</strong> int</li>
</ul>
</li>
<li>
<p><a name="get_elapsed_time"></a><strong><font color="#7fb800">get_elapsed_time</font></strong>(<font color="#00a6ed"><strong>self</strong></font>, <font color="#00a6ed"><strong>frame</strong></font>)<br />
返回一个包含特定帧的已用时间的浮点数。</p>
<ul>
<li><strong>Return —</strong> float</li>
<li><strong>Parameters</strong><ul>
<li><code>frame</code> (<em>int</em>) — 帧号。</li>
</ul>
</li>
</ul>
</li>
<li>
<p><a name="get_delta_time"></a><strong><font color="#7fb800">get_delta_time</font></strong>(<font color="#00a6ed"><strong>self</strong></font>, <font color="#00a6ed"><strong>frame</strong></font>)<br />
返回具有特定帧的增量时间的浮点数。R</p>
<ul>
<li><strong>Return —</strong> float</li>
<li><strong>Parameters</strong><ul>
<li><code>frame</code> (<em>int</em>) — 帧号。</li>
</ul>
</li>
</ul>
</li>
<li>
<p><a name="get_platform_time"></a><strong><font color="#7fb800">get_platform_time</font></strong>(<font color="#00a6ed"><strong>self</strong></font>, <font color="#00a6ed"><strong>frame</strong></font>)<br />
返回具有特定帧的平台时间的浮点数。</p>
<ul>
<li><strong>Return —</strong> float</li>
<li><strong>Parameters</strong><ul>
<li><code>frame</code> (<em>int</em>) — 帧号。</li>
</ul>
</li>
</ul>
</li>
</ul>
<h3 id="_7">参与者加速度</h3>
<ul>
<li>
<p><a name="get_actor_acceleration"></a><strong><font color="#7fb800">get_actor_acceleration</font></strong>(<font color="#00a6ed"><strong>self</strong></font>, <font color="#00a6ed"><strong>actor_id</strong></font>, <font color="#00a6ed"><strong>frame</strong></font>)<br />
返回给定帧处参与者的加速度。如果参与者<code>id</code>不存在、参与者没有加速度或者参与者在该帧中不存在，则返回<b>None</b> 。</p>
<ul>
<li><strong>Return —</strong> <a href="https://carla.readthedocs.io/en/latest/python_api/#carlavector3d">carla.Vector3D</a></li>
<li><strong>Parameters</strong><ul>
<li><code>actor_id</code> (<em>int</em>) — 参与者<code>id</code>。</li>
<li><code>frame</code> (<em>int</em>) — 帧号。</li>
</ul>
</li>
</ul>
</li>
<li>
<p><a name="get_all_actor_accelerations"></a><strong><font color="#7fb800">get_all_actor_accelerations</font></strong>(<font color="#00a6ed"><strong>self</strong></font>, <font color="#00a6ed"><strong>actor_id</strong></font>, <font color="#00a6ed"><strong>first_frame</strong>=None</font>, <font color="#00a6ed"><strong>last_frame</strong>=None</font>)<br />
返回包含参与者在帧间隔内的所有加速度的列表。默认情况下，帧间隔包含所有记录。</p>
<ul>
<li><strong>Return —</strong> list(carla.Vector3D)</li>
<li><strong>Parameters</strong><ul>
<li><code>actor_id</code> (<em>int</em>) — 参与者的<code>id</code>。</li>
<li><code>first_frame</code> (<em>int</em>) — 间隔的初始帧。默认情况下，仿真开始。</li>
<li><code>last_frame</code> (<em>int</em>) — 间隔的最后一帧。默认情况下，仿真结束。</li>
</ul>
</li>
</ul>
</li>
<li>
<p><a name="get_actor_accelerations_at_frame"></a><strong><font color="#7fb800">get_actor_accelerations_at_frame</font></strong>(<font color="#00a6ed"><strong>self</strong></font>, <font color="#00a6ed"><strong>frame</strong></font>, <font color="#00a6ed"><strong>actor_list</strong>=None</font>)<br />
返回一个字典，其中键是帧编号，值是给定帧处参与者的 carla.Vector3D。默认情况下，会考虑所有参与者，但如果传递了<em>actor_list</em>，则仅检查列表中的参与者。</p>
<ul>
<li><strong>Return —</strong> list(carla.Vector3D)</li>
<li><strong>Parameters</strong><ul>
<li><code>frame</code> (<em>int</em>) — 帧号。</li>
<li><code>actor_list</code> (<em>int</em>) — 参与者 <code>id</code>的列表。</li>
</ul>
</li>
</ul>
</li>
</ul>
<h3 id="_8">参与者角速度</h3>
<ul>
<li>
<p><a name="get_actor_angular_velocity"></a><strong><font color="#7fb800">get_actor_angular_velocity</font></strong>(<font color="#00a6ed"><strong>self</strong></font>, <font color="#00a6ed"><strong>actor_id</strong></font>, <font color="#00a6ed"><strong>frame</strong></font>)<br />
返回给定帧处参与者的角速度。如果参与者 id 不存在、参与者没有角速度或者参与者在该帧中不存在，则返回<b>None</b> 。</p>
<ul>
<li><strong>Return —</strong> carla.Vector3D</li>
<li><strong>Parameters</strong><ul>
<li><code>actor_id</code> (<em>int</em>) — 参与者的<code>id</code>。</li>
<li><code>frame</code> (<em>int</em>) — 帧的数目。</li>
</ul>
</li>
</ul>
</li>
<li>
<p><a name="get_all_actor_angular_velocities"></a><strong><font color="#7fb800">get_all_actor_angular_velocities</font></strong>(<font color="#00a6ed"><strong>self</strong></font>, <font color="#00a6ed"><strong>actor_id</strong></font>, <font color="#00a6ed"><strong>first_frame</strong>=None</font>, <font color="#00a6ed"><strong>last_frame</strong>=None</font>)<br />
返回包含参与者在帧间隔内的所有角速度的列表。默认情况下，帧间隔包含所有记录。</p>
<ul>
<li><strong>Return —</strong> list(carla.Vector3D)</li>
<li><strong>Parameters</strong><ul>
<li><code>actor_id</code> (<em>int</em>) — 参与者的<code>id</code>。</li>
<li><code>first_frame</code> (<em>int</em>) — 间隔的初始帧。默认情况下，仿真开始。</li>
<li><code>last_frame</code> (<em>int</em>) — 间隔的最后一帧。默认情况下，仿真结束。</li>
</ul>
</li>
</ul>
</li>
<li>
<p><a name="get_actor_angular_velocities_at_frame"></a><strong><font color="#7fb800">get_actor_angular_velocities_at_frame</font></strong>(<font color="#00a6ed"><strong>self</strong></font>, <font color="#00a6ed"><strong>frame</strong></font>, <font color="#00a6ed"><strong>actor_list</strong>=None</font>)<br />
返回一个字典，其中键是帧编号，值是给定帧处参与者的<a href="https://carla.readthedocs.io/en/latest/python_api/#carlavector3d">carla.Vector3D</a> 。默认情况下，会考虑所有参与者，但如果传递<code>actor_list</code>，则仅检查列表中的参与者。 </p>
<ul>
<li><strong>Return —</strong> list(<a href="https://carla.readthedocs.io/en/latest/python_api/#carlavector3d">carla.Vector3D</a>)</li>
<li><strong>Parameters</strong><ul>
<li><code>frame</code> (<em>int</em>) — 帧号。</li>
<li><code>actor_list</code> (<em>int</em>) — 参与者的 ids 列表。</li>
</ul>
</li>
</ul>
</li>
</ul>
<h3 id="_9">参与者控制</h3>
<ul>
<li>
<p><a name="get_vehicle_control"></a><strong><font color="#7fb800">get_vehicle_control</font></strong>(<font color="#00a6ed"><strong>self</strong></font>, <font color="#00a6ed"><strong>vehicle_id</strong></font>, <font color="#00a6ed"><strong>frame</strong></font>)<br />
返回给定帧处车辆的控制。该 <code>manual_gear_shift</code> 属性将始终为 False。</p>
<ul>
<li><strong>Return —</strong> <a href="https://carla.readthedocs.io/en/latest/python_api/#carlavehiclecontrol">carla.VehicleControl</a></li>
<li><strong>Parameters</strong><ul>
<li><code>vehicle_id</code> (<em>int</em>) — 车辆的<code>id</code>。</li>
<li><code>frame</code> (<em>int</em>) — 帧号。</li>
</ul>
</li>
</ul>
</li>
<li>
<p><a name="get_vehicle_physics_control"></a><strong><font color="#7fb800">get_vehicle_physics_control</font></strong>(<font color="#00a6ed"><strong>self</strong></font>, <font color="#00a6ed"><strong>vehicle_id</strong></font>, <font color="#00a6ed"><strong>frame</strong></font>)<br />
返回给定帧处车辆的物理控制。</p>
<ul>
<li><strong>Return —</strong> <a href="https://carla.readthedocs.io/en/latest/python_api/#carlavehiclephysicscontrol">carla.VehiclePhysicsControl</a></li>
<li><strong>Parameters</strong><ul>
<li><code>vehicle_id</code> (<em>int</em>) — 车辆的<code>id</code>。</li>
<li><code>frame</code> (<em>int</em>) — 帧号。</li>
</ul>
</li>
</ul>
</li>
<li>
<p><a name="get_walker_speed"></a><strong><font color="#7fb800">get_walker_speed</font></strong>(<font color="#00a6ed"><strong>self</strong></font>, <font color="#00a6ed"><strong>walker_id</strong></font>, <font color="#00a6ed"><strong>frame</strong></font>)<br />
返回给定帧处行人的速度。</p>
<ul>
<li><strong>Return —</strong> <a href="https://carla.readthedocs.io/en/latest/python_api/#carlavector3d">carla.Vector3D</a></li>
<li><strong>Parameters</strong><ul>
<li><code>walker_id</code> (<em>int</em>) — 行人的<code>id</code>。</li>
<li><code>frame</code> (<em>int</em>) — 帧号。</li>
</ul>
</li>
</ul>
</li>
</ul>
<h3 id="_10">参与者变换</h3>
<ul>
<li>
<p><a name="get_actor_transform"></a><strong><font color="#7fb800">get_actor_transform</font></strong>(<font color="#00a6ed"><strong>self</strong></font>, <font color="#00a6ed"><strong>actor_id</strong></font>, <font color="#00a6ed"><strong>frame</strong></font>)<br />
返回给定帧处参与者的变换。如果参与者 id 不存在、参与者没有变换或者参与者在该帧中不存在，则返回<b>None</b> 。</p>
<ul>
<li><strong>Return —</strong> <a href="https://carla.readthedocs.io/en/latest/python_api/#carlatransform">carla.Transform</a></li>
<li><strong>Parameters</strong><ul>
<li><code>actor_id</code> (<em>int</em>) — 参与者的<code>id</code>。</li>
<li><code>frame</code> (<em>int</em>) — 帧号。</li>
</ul>
</li>
</ul>
</li>
<li>
<p><a name="get_all_actor_transforms"></a><strong><font color="#7fb800">get_all_actor_transforms</font></strong>(<font color="#00a6ed"><strong>self</strong></font>, <font color="#00a6ed"><strong>actor_id</strong></font>, <font color="#00a6ed"><strong>first_frame</strong>=None</font>, <font color="#00a6ed"><strong>last_frame</strong>=None</font>)<br />
返回一个列表，其中包含参与者在帧间隔内的所有变换。默认情况下，帧间隔包含所有记录。 </p>
<ul>
<li><strong>Return —</strong> list(<a href="https://carla.readthedocs.io/en/latest/python_api/#carlatransform">carla.Transform</a>)</li>
<li><strong>Parameters</strong><ul>
<li><code>actor_id</code> (<em>int</em>) — 参与者的<code>id</code>。</li>
<li><code>first_frame</code> (<em>int</em>) — 间隔的初始帧。默认情况下，仿真开始。</li>
<li><code>last_frame</code> (<em>int</em>) — 间隔的最后一帧。默认情况下，仿真结束。</li>
</ul>
</li>
</ul>
</li>
<li>
<p><a name="get_actor_transforms_at_frame"></a><strong><font color="#7fb800">get_actor_transforms_at_frame</font></strong>(<font color="#00a6ed"><strong>self</strong></font>, <font color="#00a6ed"><strong>frame</strong></font>, <font color="#00a6ed"><strong>actor_list</strong>=None</font>)<br />
返回一个字典，其中键是帧编号，值是给定帧处参与者的 <a href="https://carla.readthedocs.io/en/latest/python_api/#carlatransform">carla.Transform</a>。默认情况下，会考虑所有参与者，但如果 <code>actor_list</code> 通过，则仅检查列表中的参与者。</p>
<ul>
<li><strong>Return —</strong> list(<a href="https://carla.readthedocs.io/en/latest/python_api/#carlatransform">carla.Transform</a>)</li>
<li><strong>Parameters</strong><ul>
<li><code>frame</code> (<em>int</em>) — 帧号。</li>
<li><code>actor_list</code> (<em>int</em>) — 参与者 <code>id</code> 列表。 </li>
</ul>
</li>
</ul>
</li>
</ul>
<h3 id="_11">参与者速度</h3>
<ul>
<li>
<p><a name="get_actor_velocity"></a><strong><font color="#7fb800">get_actor_velocity</font></strong>(<font color="#00a6ed"><strong>self</strong></font>, <font color="#00a6ed"><strong>actor_id</strong></font>, <font color="#00a6ed"><strong>frame</strong></font>)<br />
返回给定帧处参与者的速度。如果参与者 id 不存在、参与者没有速度或者参与者在该帧中不存在，则返回<b>None</b> 。 </p>
<ul>
<li><strong>Return —</strong> <a href="https://carla.readthedocs.io/en/latest/python_api/#carlavector3d">carla.Vector3D</a></li>
<li><strong>Parameters</strong><ul>
<li><code>actor_id</code> (<em>int</em>) — 参与者的<code>id</code>。</li>
<li><code>frame</code> (<em>int</em>) — 帧号。</li>
</ul>
</li>
</ul>
</li>
<li>
<p><a name="get_all_actor_velocities"></a><strong><font color="#7fb800">get_all_actor_velocities</font></strong>(<font color="#00a6ed"><strong>self</strong></font>, <font color="#00a6ed"><strong>actor_id</strong></font>, <font color="#00a6ed"><strong>first_frame</strong>=None</font>, <font color="#00a6ed"><strong>last_frame</strong>=None</font>)<br />
返回包含参与者在帧间隔内的所有速度的列表。默认情况下，帧间隔包含所有记录。 </p>
<ul>
<li><strong>Return —</strong> list(<a href="https://carla.readthedocs.io/en/latest/python_api/#carlavector3d">carla.Vector3D</a>)</li>
<li><strong>Parameters</strong><ul>
<li><code>actor_id</code> (<em>int</em>) — 参与者的<code>id</code>。</li>
<li><code>first_frame</code> (<em>int</em>) — 间隔的初始帧。默认情况下，仿真开始。</li>
<li><code>last_frame</code> (<em>int</em>) — 间隔的最后一帧。默认情况下，仿真结束。</li>
</ul>
</li>
</ul>
</li>
<li>
<p><a name="get_actor_velocities_at_frame"></a><strong><font color="#7fb800">get_actor_velocities_at_frame</font></strong>(<font color="#00a6ed"><strong>self</strong></font>, <font color="#00a6ed"><strong>frame</strong></font>, <font color="#00a6ed"><strong>actor_list</strong>=None</font>)<br />
返回一个字典，其中键是帧编号，值是给定帧处参与者的 carla.Vector3D。默认情况下，会考虑所有参与者，但如果传递了<em>actor_list</em>，则仅检查列表中的参与者。 </p>
<ul>
<li><strong>Return —</strong> list(<a href="https://carla.readthedocs.io/en/latest/python_api/#carlavector3d">carla.Vector3D</a></li>
<li><strong>Parameters</strong><ul>
<li><code>frame</code> (<em>int</em>) — 帧号。</li>
<li><code>actor_list</code> (<em>int</em>) — 参与者<code>id</code>列表。 </li>
</ul>
</li>
</ul>
</li>
</ul>
<h3 id="_12">场景灯</h3>
<ul>
<li><a name="get_scene_light_state"></a><strong><font color="#7fb800">get_scene_light_state</font></strong>(<font color="#00a6ed"><strong>self</strong></font>, <font color="#00a6ed"><strong>light</strong></font>, <font color="#00a6ed"><strong>vehicle_id</strong></font>, <font color="#00a6ed"><strong>frame</strong></font>)<br />
Returns the state of a scene light for a given frame. The light state group will always be <a href="https://carla.readthedocs.io/en/latest/python_api/#carlalightgroup">carla.LightGroup.None</a>.<ul>
<li><strong>Return —</strong> carla.LightState</li>
<li><strong>Parameters</strong><ul>
<li><code>light_id</code> (<em>int</em>) — 场景灯的<code>id</code>。</li>
<li><code>frame</code> (<em>int</em>) — 帧号。</li>
</ul>
</li>
</ul>
</li>
</ul>
<h3 id="_13">红绿灯</h3>
<ul>
<li>
<p><a name="get_traffic_light_state"></a><strong><font color="#7fb800">get_traffic_light_state</font></strong>(<font color="#00a6ed"><strong>self</strong></font>, <font color="#00a6ed"><strong>traffic_light_id</strong></font>, <font color="#00a6ed"><strong>frame</strong></font>)<br />
返回给定帧的红绿灯状态。</p>
<ul>
<li><strong>Return —</strong> <a href="https://carla.readthedocs.io/en/latest/python_api/#carlatrafficlightstate">carla.TrafficLightState</a>.</li>
<li><strong>Parameters</strong><ul>
<li><code>traffic_light_id</code> (<em>int</em>) — 红绿灯的<code>id</code>。</li>
<li><code>frame</code> (<em>int</em>) — 帧号。</li>
</ul>
</li>
</ul>
</li>
<li>
<p><a name="is_traffic_light_frozen"></a><strong><font color="#7fb800">is_traffic_light_frozen</font></strong>(<font color="#00a6ed"><strong>self</strong></font>, <font color="#00a6ed"><strong>traffic_light_id</strong></font>, <font color="#00a6ed"><strong>frame</strong></font>)<br />
返回交通信号灯是否冻结在给定帧。</p>
<ul>
<li><strong>Return —</strong> bool</li>
<li><strong>Parameters</strong><ul>
<li><code>traffic_light_id</code> (<em>int</em>) — 交通灯的<code>id</code>。</li>
<li><code>frame</code> (<em>int</em>) — 帧号。</li>
</ul>
</li>
</ul>
</li>
<li>
<p><a name="get_traffic_light_elapsed_time"></a><strong><font color="#7fb800">get_traffic_light_elapsed_time</font></strong>(<font color="#00a6ed"><strong>self</strong></font>, <font color="#00a6ed"><strong>traffic_light_id</strong></font>, <font color="#00a6ed"><strong>frame</strong></font>)<br />
返回给定帧处交通灯的经过时间。</p>
<ul>
<li><strong>Return —</strong> float</li>
<li><strong>Parameters</strong><ul>
<li><code>traffic_light_id</code> (<em>int</em>) — 交通灯的<code>id</code>。</li>
<li><code>frame</code> (<em>int</em>) — 帧号。</li>
</ul>
</li>
</ul>
</li>
<li>
<p><a name="get_traffic_light_state_time"></a><strong><font color="#7fb800">get_traffic_light_state_time</font></strong>(<font color="#00a6ed"><strong>self</strong></font>, <font color="#00a6ed"><strong>traffic_light_id</strong></font>, <font color="#00a6ed"><strong>state</strong></font>, <font color="#00a6ed"><strong>frame</strong></font>)<br />
返回给定帧处交通灯特定状态的最长时间。</p>
<ul>
<li><strong>Return —</strong> float</li>
<li><strong>Parameters</strong><ul>
<li><code>traffic_light_id</code> (<em>int</em>) — <code>id</code> of the traffic light.</li>
<li><code>state</code> (<a href="https://carla.readthedocs.io/en/latest/python_api/#carlatrafficlightstate">carla.TrafficLightState</a>) — 参与者的<code>id</code>。</li>
<li><code>frame</code> (<em>int</em>) — 帧号。</li>
</ul>
</li>
</ul>
</li>
</ul>
<h3 id="_14">车灯</h3>
<ul>
<li>
<p><a name="get_vehicle_lights"></a><strong><font color="#7fb800">get_vehicle_lights</font></strong>(<font color="#00a6ed"><strong>self</strong></font>, <font color="#00a6ed"><strong>vehicle_id</strong></font>, <font color="#00a6ed"><strong>frame</strong></font>)<br />
返回一个列表，其中包含给定帧处特定车辆的活动灯。</p>
<ul>
<li><strong>Return —</strong> list(<a href="https://carla.readthedocs.io/en/latest/python_api/#carlavehiclelightstate">carla.VehicleLightState</a>)</li>
<li><strong>Parameters</strong><ul>
<li><code>vehicle_id</code> (<em>int</em>) — 车辆的<code>id</code>。</li>
<li><code>frame</code> (<em>int</em>) — 帧号。</li>
</ul>
</li>
</ul>
</li>
<li>
<p><a name="is_vehicle_light_active"></a><strong><font color="#7fb800">is_vehicle_light_active</font></strong>(<font color="#00a6ed"><strong>self</strong></font>, <font color="#00a6ed"><strong>light</strong></font>, <font color="#00a6ed"><strong>vehicle_id</strong></font>, <font color="#00a6ed"><strong>frame</strong></font>)<br />
检查给定车辆灯在特定帧是否处于活动状态。</p>
<ul>
<li><strong>Return —</strong> bool</li>
<li><strong>Parameters</strong><ul>
<li><code>light</code> (<a href="https://carla.readthedocs.io/en/latest/python_api/#carlavehiclelightstate">carla.VehicleLightState</a>) — 与车辆进行比较的灯光状态。</li>
<li><code>vehicle_id</code> (<em>int</em>) — 车辆的<code>id</code>。</li>
<li><code>frame</code> (<em>int</em>) — 帧号。</li>
</ul>
</li>
</ul>
</li>
</ul>
              
            </div>
          </div><footer>

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
  </div>

</footer>
          
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
    
    
  </span>
</div>
    <script src="../../js/jquery-3.6.0.min.js"></script>
    <script>var base_url = "../..";</script>
    <script src="../../js/theme_extra.js"></script>
    <script src="../../js/theme.js"></script>
      <script src="../../extra.js"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.4/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
      <script src="../../search/main.js"></script>
    <script>
        jQuery(function () {
            SphinxRtdTheme.Navigation.enable(true);
        });
    </script>

</body>
</html>

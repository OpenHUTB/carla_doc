<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
      <link rel="shortcut icon" href="../img/favicon.ico" />
    <title>记录器二进制文件格式 - 交通仿真器文档</title>
    <link rel="stylesheet" href="../css/theme.css" />
    <link rel="stylesheet" href="../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" />
        <link href="../extra.css" rel="stylesheet" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "\u8bb0\u5f55\u5668\u4e8c\u8fdb\u5236\u6587\u4ef6\u683c\u5f0f";
        var mkdocs_page_input_path = "ref_recorder_binary_file_format.md";
        var mkdocs_page_url = null;
      </script>
    
    <!--[if lt IE 9]>
      <script src="../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
      <script>hljs.highlightAll();</script> 
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href=".." class="icon icon-home"> 交通仿真器文档
        </a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="..">主页</a>
                </li>
              </ul>
              <p class="caption"><span class="caption-text">入门</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../start_introduction/">介绍</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../start_quickstart/">快速启动包安装</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../tuto_first_steps/">第一步</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../tutorials/">教程</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">构建 Carla</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../build_carla/">构建 Carla</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../build_linux/">Linux 上编译</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../build_windows/">Windows 上编译</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../build_update/">Carla 更新</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../build_system/">编译系统</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../build_docker/">Docker 中的 Carla</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../build_faq/">常问的问题</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Carla 主题</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../foundations/">概念和基础</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../core_world/">第一、世界和客户端</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../core_actors/">第二、参与者和蓝图</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../core_map/">第三、地图和导航 </a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../core_sensors/">第四、传感器和数据</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../development_tutorials/">开发</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../custom_assets_tutorials/">自定义资产</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../tuto_content_authoring_maps/">内容创作 - 地图</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../tuto_content_authoring_vehicles/">内容创作 - 车辆</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">交通仿真</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../ts_traffic_simulation_overview/">交通</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../adv_traffic_manager/">交通管理器</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../adv_sumo/">和 SUMO 联合仿真</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../tuto_G_scenic/">Scenic</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">高级概念</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../adv_opendrive/">OpenDRIVE 独立模式</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../adv_recorder/">记录器</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../adv_rendering_options/">渲染选项</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../adv_rss/">责任敏感安全</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../adv_synchrony_timestep/">同步和时间步长</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../adv_benchmarking/">基准性能</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../adv_agents/">Carla 智能体</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">资源</span></p>
              <ul class="current">
                  <li class="toctree-l1"><a class="reference internal" href="../python_api/">Python API 参考</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../ref_cpp/">C++ 参考</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../bp_library/">蓝图库</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../catalogue/">Carla 目录</a>
                  </li>
                  <li class="toctree-l1 current"><a class="reference internal current" href="#">记录器二进制文件格式</a>
    <ul class="current">
    <li class="toctree-l2"><a class="reference internal" href="#1-">1- 二进制字符串</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#2-">2- 信息头</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#3-">3- 数据包</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#0-">数据包 0 - 帧开始</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#1-_1">数据包 1 - 帧结束</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#2-_1">数据包 2 - 事件添加</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#3-_1">数据包 3 - 事件删除</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#4-">数据包 4 - 事件父级</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#5-">数据包 5 - 事件碰撞</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#6-">数据包 6 - 位置</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#7-">数据包 7 - 交通灯</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#8-">数据包 8 - 车辆动画</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#9-">数据包 9 - 行人动画</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#4-_1">4- 帧布局</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#5-_1">5- 文件布局</a>
    </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../ref_sensors/">传感器参考</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../ext_docs/">扩展文档</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">自定义地图</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../tuto_M_custom_map_overview/">Carla 中自定义地图的概述</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../tuto_M_generate_map/">在 RoadRunner 中创建地图</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../tuto_M_add_map_package/">在 Carla 包导入地图</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../tuto_M_add_map_source/">在 Carla 源构建中导入地图</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../tuto_M_add_map_alternative/">导入地图的替代方法</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../tuto_M_manual_map_package/">手动准备地图包</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../tuto_M_custom_layers/">自定义地图：分层地图</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../tuto_M_custom_add_tl/">自定义地图：红绿灯和标志</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../tuto_M_custom_road_painter/">自定义地图：道路画家</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../tuto_M_custom_buildings/">自定义地图：程序建筑</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../tuto_M_custom_weather_landscape/">自定义地图：天气和景观</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../tuto_M_generate_pedestrian_navigation/">生成行人导航</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">大地图</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../large_map_overview/">大地图概述</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../large_map_roadrunner/">在RoadRunner中创建大地图</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../large_map_import/">导入/打包大地图</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">教程（通用）</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../tuto_G_add_friction_triggers/">添加摩擦触发器</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../tuto_G_control_vehicle_physics/">控制车辆物理模型</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../tuto_G_control_walker_skeletons/">控制行人骨骼</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../tuto_G_openstreetmap/">使用 OpenStreetMap 生成地图</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../tuto_G_retrieve_data/">检索仿真数据</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../build_docker_unreal/">在 Docker 中构建虚幻引擎和 Carla</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">教程（资产）</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../tuto_A_add_vehicle/">添加新车辆</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../tuto_A_add_props/">添加新道具</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../tuto_A_create_standalone/">创建独立包</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../tuto_A_material_customization/">材质定制</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">教程（开发人员）</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../tuto_D_contribute_assets/">如何升级内容</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../tuto_D_create_sensor/">创建一个传感器</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../tuto_D_create_semantic_tags/">创建语义标签</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../tuto_D_customize_vehicle_suspension/">自定义车辆悬架</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../tuto_D_generate_colliders/">生成详细碰撞</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../tuto_D_make_release/">发布版本</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">示例</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../tuto_G_traffic_light/">交通灯的配置和使用</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../tuto_G_traffic_prediction/">流量预测</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Carla 生态系统</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../ecosys_iss/">ISS 智能驾驶系统</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../plugins_carlaviz/">Web 可视化器</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../ros_documentation/">ROS</a>
                  </li>
                  <li class="toctree-l1"><a class="" href="../GPUOpen-Effects/FEMFX.md">有限元变形材料虚幻插件</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../tuto_G_carsim_integration/">CarSim 集成</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../tuto_G_rllib_integration/">RLlib 集成</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../tuto_G_chrono/">Chrono 集成</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../OpenRadioss/use_OpenRadioss_windows/">OpenRadios 有限元仿真</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../adv_ptv/">PTV-Vissim 联合仿真</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../ecosys_ansys/">Ansys 实时雷达模型</a>
                  </li>
                  <li class="toctree-l1"><a class="" href="https://github.com/darkscyla/MATLAB-Carla-Interface">Matlab 接口</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../tuto_G_G29_windows/">罗技 G29 方向盘</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">贡献</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../cont_contribution_guidelines/">贡献指南</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../cont_code_of_conduct/">行为准则</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../cont_coding_standard/">编码标准</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../cont_doc_standard/">文档标准</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">其他</span></p>
              <ul>
                  <li class="toctree-l1"><a class="" href="https://ww2.mathworks.cn/help/roadrunner/index.html">RoadRunner</a>
                  </li>
                  <li class="toctree-l1"><a class="" href="https://ww2.mathworks.cn/help/roadrunner-scenario/index.html">RoadRunner Scenario</a>
                  </li>
                  <li class="toctree-l1"><a class="" href="https://bbs.carla.org.cn/">Carla 中文站</a>
                  </li>
                  <li class="toctree-l1"><a class="" href="https://github.com/OpenHUTB/engine_doc">虚幻引擎教程</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../todo/">待做列表</a>
                  </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="..">交通仿真器文档</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href=".." class="icon icon-home" aria-label="Docs"></a></li>
          <li class="breadcrumb-item">资源</li>
      <li class="breadcrumb-item active">记录器二进制文件格式</li>
    <li class="wy-breadcrumbs-aside">
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <h1 id="_1"><a href="https://carla.readthedocs.io/en/latest/ref_recorder_binary_file_format/">记录器二进制文件格式</a></h1>
<p>记录器系统将重放仿真所需的所有信息保存在二进制文件中，对多字节值使用小端字节顺序。</p>
<ul>
<li><a href="#1-strings-in-binary"><strong>1- 二进制字符串</strong></a>  </li>
<li><a href="#2-info-header"><strong>2- 信息头</strong></a>  </li>
<li><a href="#3-packets"><strong>3- 数据包</strong></a>  <ul>
<li><a href="#packet-0-frame-start">数据包 0 - 帧开始</a>  </li>
<li><a href="#packet-1-frame-end">数据包 1 - 帧结束</a>  </li>
<li><a href="#packet-2-event-add">数据包 2 - 事件添加</a>  </li>
<li><a href="#packet-3-event-del">数据包 3 - 事件删除</a>  </li>
<li><a href="#packet-4-event-parent">数据包 4 - 事件父级</a>  </li>
<li><a href="#packet-5-event-collision">数据包 5 - 事件碰撞</a>  </li>
<li><a href="#packet-6-position">数据包 6 - 位置</a>  </li>
<li><a href="#packet-7-trafficlight">数据包 7 - 交通灯</a>  </li>
<li><a href="#packet-8-vehicle-animation">数据包 8 - 车辆动画</a>  </li>
<li><a href="#packet-9-walker-animation">数据包 9 - 行人动画</a>  </li>
</ul>
</li>
<li><a href="#4-frame-layout"><strong>4- 帧布局</strong></a>  </li>
<li><a href="#5-file-layout"><strong>5- 文件布局</strong></a>  </li>
</ul>
<p>在下一张代表文件格式的图像中，我们可以快速查看所有详细信息。图像中可视化的每个部分将在以下部分中进行解释：</p>
<p><img alt="file format 1" src="../img/RecorderFileFormat1.jpg" /></p>
<p>总之，该文件格式有一个小头，其中包含一般信息（版本、魔术字符串、日期和使用的地图）和不同类型的数据包集合（目前我们使用 10 种类型，但将来会继续增长） 。</p>
<p><img alt="global file format" src="../img/RecorderFileFormat3.jpg" /></p>
<hr />
<h2 id="1-">1- 二进制字符串</h2>
<p>字符串首先使用其长度进行编码，然后是其字符（不以空字符结尾）。例如，字符串“Town06”将保存为十六进制值：06 00 54 6f 77 6e 30 36</p>
<p><img alt="binary dynamic string" src="../img/RecorderString.jpg" /></p>
<hr />
<h2 id="2-">2- 信息头</h2>
<p>信息标头包含有关录制文件的一般信息。基本上，它包含版本和一个魔术字符串，用于将该文件标识为记录器文件。如果标题发生变化，那么版本也会发生变化。此外，它还包含一个日期时间戳，以及从 1900 年开始的秒数，并且还包含一个字符串，其中包含用于记录的地图名称。</p>
<p><img alt="info header" src="../img/RecorderInfoHeader.jpg" /></p>
<p>示例信息头是：</p>
<p><img alt="info header sample" src="../img/RecorderHeader.jpg" /></p>
<hr />
<h2 id="3-">3- 数据包</h2>
<p>每个数据包以两个字段（5 个字节）的小标头开头：</p>
<p><img alt="packet header" src="../img/RecorderPacketHeader.jpg" /></p>
<ul>
<li><strong>id</strong>: 数据包类型</li>
<li><strong>size</strong>: 数据包数据的大小</li>
</ul>
<p>头信息后面跟着<strong>数据</strong>。数据是可选的，<strong>大小</strong>为 0 表示数据包中没有<strong>数据</strong>。如果<strong>大小</strong>大于 0，则表示数据包有<strong>数据</strong>字节。因此，需要根据数据包的类型重新解释<strong>数据</strong>。</p>
<p>数据包的头很有用，因为我们可以在播放时忽略那些我们不感兴趣的数据包。我们只需要读取数据包的头（前 5 个字节）并跳过数据包的数据跳转到下一个数据包：</p>
<p><img alt="packets size" src="../img/RecorderPackets.jpg" /></p>
<p>数据包的类型有：</p>
<p><img alt="packets type list" src="../img/RecorderPacketsList.jpg" /></p>
<p>我们建议用户自定义数据包使用超过 100 的 <strong>id</strong>，因为这个列表将来会不断增长。</p>
<h3 id="0-">数据包 0 - 帧开始</h3>
<p>该数据包标记新帧的开始，并且它将是开始每个帧的第一个数据包。所有数据包都需要放置在<strong>Frame Start</strong>和<strong>Frame End</strong>之间。</p>
<p><img alt="frame start" src="../img/RecorderFrameStart.jpg" /></p>
<p>因此，经过时间 + 持续时间 = 下一帧经过的时间。</p>
<h3 id="1-_1">数据包 1 - 帧结束</h3>
<p>该帧没有数据，仅标记当前帧的结束。这有助于重放器在新一帧开始之前知道每一帧的结束。通常，下一帧应该是帧起始数据包以开始新帧。</p>
<p><img alt="frame end" src="../img/RecorderFrameEnd.jpg" /></p>
<h3 id="2-_1">数据包 2 - 事件添加</h3>
<p>这个数据包说明了我们需要在当前帧创建多少个参与者。</p>
<p><img alt="event add" src="../img/RecorderEventAdd.jpg" /></p>
<p>字段<strong>总计</strong>表示后面有多少条记录。每条记录都以<strong>id</strong>字段开头，即参与者在录制时所拥有的 id（在播放时，该 id 可以在内部更改，但我们需要使用此 id ）。参与者的<strong>类型</strong>可以有以下可能的值：</p>
<ul>
<li>0 = 其他</li>
<li>1 = 车辆</li>
<li>2 = 行人</li>
<li>3 = 交通灯</li>
<li>4 = 无效</li>
</ul>
<p>之后，继续我们想要创建参与者的<strong>位置</strong>和<strong>旋转</strong>。</p>
<p>在我们得到参与者的描述之后。描述 <strong>uid</strong> 是描述的数字 ID，而 <strong>id</strong> 是文本 ID，例如"vehicle.seat.leon"。</p>
<p>然后是其<strong>属性</strong>的集合，例如颜色、轮子数量、角色等。属性的数量是可变的，应该类似于以下内容：</p>
<ul>
<li>number_of_wheels = 4</li>
<li>sticky_control = true</li>
<li>color = 79,33,85</li>
<li>role_name = autopilot</li>
</ul>
<h3 id="3-_1">数据包 3 - 事件删除</h3>
<p>这个数据包说明了这一帧需要销毁多少个参与者。</p>
<p><img alt="event del" src="../img/RecorderEventDel.jpg" /></p>
<p>它有记录<strong>总数</strong>，每条记录都有要删除的参与者的ID 。</p>
<p>例如，这个数据包可能是这样的：</p>
<p><img alt="event del" src="../img/RecorderPacketSampleEventDel.jpg" /></p>
<p>数字 3 将数据包标识为事件删除。数字 16 是数据包数据的大小（4 个字段，每个字段 4 字节）。因此，如果我们不想处理这个数据包，我们可以跳过接下来的 16 个字节，直接进入下一个数据包的开头。接下来的 3 表示后面的总记录，每条记录都是要删除的参与者的 id。因此，我们需要在这一帧中删除参与者 100、101 和 120。</p>
<h3 id="4-">数据包 4 - 事件父级</h3>
<p>该数据包说明哪个参与者是另一个参与者（父母）的孩子。</p>
<p><img alt="event parent" src="../img/RecorderEventParent.jpg" /></p>
<p>第一个 id 是子参与者，第二个 id 是父参与者。</p>
<h3 id="5-">数据包 5 - 事件碰撞</h3>
<p>如果两个参与者之间发生碰撞，它将被注册到这个数据包中。目前，只有具有碰撞传感器的参与者才会报告碰撞，因此目前只有英雄车辆会自动连接该传感器。</p>
<p><img alt="event collision" src="../img/RecorderCollision.jpg" /></p>
<p><strong>id</strong>只是一个用于在内部标识每次碰撞的序列。同一帧中可能会发生同一对参与者之间的多次碰撞，因为物理帧速率是固定的，并且同一渲染帧中通常存在多个物理子步骤。</p>
<h3 id="6-">数据包 6 - 位置</h3>
<p>该数据包记录场景中存在的<strong>车辆</strong>和<strong>行人</strong>类型的所有参与者的位置和方向。</p>
<p><img alt="position" src="../img/RecorderPosition.jpg" /></p>
<h3 id="7-">数据包 7 - 交通灯</h3>
<p>该数据包记录了场景中所有<strong>交通灯</strong>的状态。这意味着它存储状态（红色、橙色或绿色）以及等待更改为新状态的时间。</p>
<p><img alt="state" src="../img/RecorderTrafficLight.png" /></p>
<h3 id="8-">数据包 8 - 车辆动画</h3>
<p>该数据包记录了车辆、自行车和山地自行车的动画。该数据包存储了<strong>油门</strong>、<strong>方向盘</strong>、<strong>删车</strong>、<strong>手刹</strong>和<strong>排挡</strong>输入，然后在播放时设置它们。</p>
<p><img alt="state" src="../img/RecorderVehicle.jpg" /></p>
<h3 id="9-">数据包 9 - 行人动画</h3>
<p>该数据包记录了行人的动画。它只是保存动画中使用的行人的<strong>速度</strong>。</p>
<p><img alt="state" src="../img/RecorderWalker.jpg" /></p>
<hr />
<h2 id="4-_1">4- 帧布局</h2>
<p>一个帧由多个数据包组成，其中所有数据包都是可选的，除了那些在该帧中具有<strong>开始</strong>和<strong>结束</strong>的数据包之外，它们必须始终存在。</p>
<p><img alt="layout" src="../img/RecorderFrameLayout.jpg" /></p>
<p><strong>事件</strong> 数据包仅存在于它们发生的帧中。</p>
<p><strong>位置</strong> 和 <strong>交通灯</strong> 数据包应该存在于所有帧中，因为它们需要移动所有参与者并将交通灯设置为其状态。它们是可选的，但如果它们不存在，那么重放器将无法移动或设置交通灯的状态。</p>
<p><strong>动画</strong>包也是可选的，但默认情况下它们会被记录。这样行人就会被动画化，并且车轮也会跟随车辆的方向。</p>
<hr />
<h2 id="5-_1">5- 文件布局</h2>
<p>文件的布局以<strong>信息头</strong>开始，然后是分组的数据包集合。每组中的第一个是<strong>帧开始</strong>数据包，最后一个是<strong>帧结束</strong>数据包。在这两者之间，我们还可以找到其余的数据包。</p>
<p><img alt="layout" src="../img/RecorderLayout.jpg" /></p>
<p>通常，最好首先拥有有关事件的所有数据包，然后再拥有有关位置和状态的数据包。</p>
<p>事件包是可选的，因为它们在发生时出现，所以我们可以有这样的布局：</p>
<p><img alt="layout" src="../img/RecorderLayoutSample.jpg" /></p>
<p>在<strong>第 1 帧</strong>中，创建了一些参与者并重新设置了父级，因此我们可以在图像中观察其事件。在<strong>第 2 帧</strong>中没有事件。在<strong>第 3 帧</strong>中，一些参与者发生了碰撞，因此碰撞事件会随该信息一起出现。在<strong>第 4 帧</strong>中，参与者被摧毁。</p>
              
            </div>
          </div><footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="Footer Navigation">
        <a href="../catalogue/" class="btn btn-neutral float-left" title="Carla 目录"><span class="icon icon-circle-arrow-left"></span> Previous</a>
        <a href="../ref_sensors/" class="btn btn-neutral float-right" title="传感器参考">Next <span class="icon icon-circle-arrow-right"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
  </div>

</footer>
          
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
    
      <span><a href="../catalogue/" style="color: #fcfcfc">&laquo; Previous</a></span>
    
    
      <span><a href="../ref_sensors/" style="color: #fcfcfc">Next &raquo;</a></span>
    
  </span>
</div>
    <script src="../js/jquery-3.6.0.min.js"></script>
    <script>var base_url = "..";</script>
    <script src="../js/theme_extra.js"></script>
    <script src="../js/theme.js"></script>
      <script src="../extra.js"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.4/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
      <script src="../search/main.js"></script>
    <script>
        jQuery(function () {
            SphinxRtdTheme.Navigation.enable(true);
        });
    </script>

</body>
</html>

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
      <link rel="shortcut icon" href="../../img/favicon.ico" />
    <title>CarlaUnreal 传感器模块详细说明文档 - 人车模拟</title>
    <link rel="stylesheet" href="../../css/theme.css" />
    <link rel="stylesheet" href="../../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" />
        <link href="../../extra.css" rel="stylesheet" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "CarlaUnreal \u4f20\u611f\u5668\u6a21\u5757\u8be6\u7ec6\u8bf4\u660e\u6587\u6863";
        var mkdocs_page_input_path = "modules/Sensor_UE.md";
        var mkdocs_page_url = null;
      </script>
    
    <!--[if lt IE 9]>
      <script src="../../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
      <script>hljs.highlightAll();</script> 
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href="../.." class="icon icon-home"> 人车模拟
        </a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../..">首页</a>
                </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../..">人车模拟</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../.." class="icon icon-home" aria-label="Docs"></a></li>
      <li class="breadcrumb-item active">CarlaUnreal 传感器模块详细说明文档</li>
    <li class="wy-breadcrumbs-aside">
          <a href="https://github.com/OpenHUTB/doc/edit/master/docs/modules/Sensor_UE.md" class="icon icon-github"> Edit on GitHub</a>
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <h1 id="carlaunreal">CarlaUnreal 传感器模块详细说明文档</h1>
<h1 id="_1">目录</h1>
<ul>
<li><a href="#概述">概述</a></li>
<li><a href="#文件详细说明">文件详细说明</a></li>
<li><a href="#1-collisionsensorcpp">1. CollisionSensor.cpp</a><ul>
<li><a href="#文件路径">文件路径</a></li>
<li><a href="#功能">功能</a></li>
<li><a href="#代码结构">代码结构</a></li>
<li><a href="#依赖关系">依赖关系</a></li>
<li><a href="#使用方法">使用方法</a></li>
<li><a href="#数据输出格式">数据输出格式</a></li>
<li><a href="#性能和优化">性能和优化</a></li>
</ul>
</li>
<li><a href="#2-customv2xsensorcpp">2. CustomV2XSensor.cpp</a><ul>
<li><a href="#文件路径-1">文件路径</a></li>
<li><a href="#功能-1">功能</a></li>
<li><a href="#代码结构-1">代码结构</a></li>
<li><a href="#依赖关系-1">依赖关系</a></li>
<li><a href="#使用方法-1">使用方法</a></li>
<li><a href="#数据输出格式-1">数据输出格式</a></li>
<li><a href="#性能和优化-1">性能和优化</a></li>
</ul>
</li>
<li><a href="#3-depthcameracpp">3. DepthCamera.cpp</a><ul>
<li><a href="#文件路径-2">文件路径</a></li>
<li><a href="#功能-2">功能</a></li>
<li><a href="#代码结构-2">代码结构</a></li>
<li><a href="#依赖关系-2">依赖关系</a></li>
<li><a href="#使用方法-2">使用方法</a></li>
<li><a href="#数据输出格式-2">数据输出格式</a></li>
<li><a href="#性能和优化-2">性能和优化</a></li>
</ul>
</li>
<li><a href="#4-dvscameracpp">4. DVSCamera.cpp</a><ul>
<li><a href="#文件路径-3">文件路径</a></li>
<li><a href="#功能-3">功能</a></li>
<li><a href="#代码结构-3">代码结构</a></li>
<li><a href="#依赖关系-3">依赖关系</a></li>
<li><a href="#使用方法-3">使用方法</a></li>
<li><a href="#数据输出格式-3">数据输出格式</a></li>
<li><a href="#性能和优化-3">性能和优化</a></li>
</ul>
</li>
<li><a href="#集成和扩展">集成和扩展</a></li>
<li><a href="#依赖关系总结">依赖关系总结</a></li>
<li><a href="#扩展建议">扩展建议</a></li>
</ul>
<p>本文档详细介绍CarlaUnreal插件中传感器模块的四个具体实现文件：<code>CollisionSensor.cpp</code>、<code>CustomV2XSensor.cpp</code>、<code>DepthCamera.cpp</code> 和 <code>DVSCamera.cpp</code>。这些文件实现了Carla自动驾驶仿真器中不同类型的传感器功能，用于在Unreal Engine环境中模拟自动驾驶车辆的感知系统。文档旨在为开发者提供深入的技术参考，包括功能、实现逻辑、配置方法和使用场景。</p>
<h2 id="_2">概述</h2>
<p>CarlaUnreal是基于Unreal Engine开发的开源自动驾驶仿真平台，其传感器模块是核心组件之一，负责模拟现实世界中的感知设备。这些传感器通过继承Unreal Engine的<code>AActor</code>或<code>ASceneCaptureSensor</code>类实现，支持与Carla的客户端-服务器架构集成，允许通过Python API或ROS2接口获取数据。</p>
<p>以下四个文件分别实现不同类型的传感器功能：</p>
<ol>
<li><strong>CollisionSensor.cpp</strong>：碰撞传感器，检测车辆或行人Actor的碰撞事件，记录碰撞物体、冲量等信息。</li>
<li><strong>CustomV2XSensor.cpp</strong>：V2X通信传感器，模拟车辆间无线通信，支持消息生成和传播仿真。</li>
<li><strong>DepthCamera.cpp</strong>：深度相机，捕获场景的深度信息，生成深度图像，适用于环境感知。</li>
<li><strong>DVSCamera.cpp</strong>：动态视觉传感器（DVS），基于亮度变化生成事件流，适合高速动态场景。</li>
</ol>
<h2 id="_3">文件详细说明</h2>
<h3 id="1-collisionsensorcpp">1. CollisionSensor.cpp</h3>
<h4 id="_4">文件路径</h4>
<p><code>~/carla/Unreal/CarlaUE4/Plugins/Carla/Source/Carla/Sensor/CollisionSensor.cpp</code></p>
<h4 id="_5">功能</h4>
<ul>
<li><strong>类</strong>：<code>ACollisionSensor</code>（继承自传感器基类，推测为<code>ASensor</code>）。</li>
<li><strong>作用</strong>：检测附加到车辆或行人Actor的碰撞事件，记录碰撞的参与者（Actor）、冲量（NormalImpulse）和碰撞位置（HitResult），并将数据序列化后发送到客户端。</li>
<li><strong>应用场景</strong>：</li>
<li>自动驾驶安全性测试：检测车辆与环境（如其他车辆、行人、障碍物）的碰撞。</li>
<li>事件记录：为仿真分析提供碰撞数据。</li>
<li>ROS2集成：在机器人操作系统中处理碰撞数据。</li>
</ul>
<h4 id="_6">代码结构</h4>
<ul>
<li><strong>构造函数</strong>：</li>
<li>初始化传感器，启用每帧Tick（<code>PrimaryActorTick.bCanEverTick = true</code>）。</li>
<li><strong>主要方法</strong>：</li>
<li><code>GetSensorDefinition()</code>：定义传感器蓝图，类型为<code>other.collision</code>。</li>
<li><code>SetOwner(AActor *NewOwner)</code>：绑定传感器到所有者（如车辆或行人），动态注册碰撞事件回调：<ul>
<li>对于<code>ACarlaWheeledVehicle</code>，绑定到车辆网格的<code>OnComponentHit</code>事件。</li>
<li>对于<code>AWalkerBase</code>，绑定到行人网格的<code>OnComponentHit</code>事件。</li>
<li>其他情况，绑定到Actor的<code>OnActorHit</code>事件。</li>
</ul>
</li>
<li><code>PrePhysTick(float DeltaSeconds)</code>：清理上一帧的碰撞记录，避免重复处理。</li>
<li><code>OnCollisionEvent(AActor *Actor, AActor *OtherActor, FVector NormalImpulse, const FHitResult &amp;Hit)</code>：<ul>
<li>验证碰撞双方有效性。</li>
<li>检查是否为新碰撞（避免同一帧重复处理）。</li>
<li>将冲量转换为米单位（<code>NormalImpulse *= 1e-2</code>）。</li>
<li>序列化碰撞数据（包括双方Actor信息和冲量），通过数据流发送。</li>
<li>记录到Carla的事件记录器（<code>GetRecorder()-&gt;AddCollision</code>）。</li>
<li>支持ROS2数据传输，包含传感器变换和冲量信息。</li>
</ul>
</li>
<li><code>OnActorCollisionEvent</code> 和 <code>OnComponentCollisionEvent</code>：分别处理Actor级和组件级碰撞，调用<code>OnCollisionEvent</code>。</li>
<li><strong>数据结构</strong>：</li>
<li><code>CollisionRegistry</code>：存储碰撞记录（帧号、碰撞双方Actor），用于去重。</li>
</ul>
<h4 id="_7">依赖关系</h4>
<ul>
<li><strong>Carla模块</strong>：<code>CarlaEpisode</code>（获取仿真帧和Actor信息）、<code>ActorRegistry</code>（序列化Actor）、<code>CarlaEngine</code>（获取帧计数器）。</li>
<li><strong>Unreal Engine</strong>：<code>AActor</code>、<code>UPrimitiveComponent</code>（碰撞检测）、<code>FHitResult</code>（碰撞细节）。</li>
<li><strong>外部接口</strong>：<code>FCarlaServer</code>（数据流）、ROS2（可选）。</li>
</ul>
<h4 id="_8">使用方法</h4>
<ol>
<li><strong>蓝图配置</strong>：</li>
<li>在Unreal Editor中，将<code>CollisionSensor</code>附加到车辆或行人Actor。</li>
<li>设置传感器ID和位置（通常与所有者Actor对齐）。</li>
<li><strong>Python API示例</strong>：
   <div class="highlight"><pre><span></span><code><span class="kn">import</span> <span class="nn">carla</span>
<span class="n">client</span> <span class="o">=</span> <span class="n">carla</span><span class="o">.</span><span class="n">Client</span><span class="p">(</span><span class="s1">&#39;localhost&#39;</span><span class="p">,</span> <span class="mi">2000</span><span class="p">)</span>
<span class="n">world</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">get_world</span><span class="p">()</span>
<span class="n">blueprint_library</span> <span class="o">=</span> <span class="n">world</span><span class="o">.</span><span class="n">get_blueprint_library</span><span class="p">()</span>
<span class="n">collision_bp</span> <span class="o">=</span> <span class="n">blueprint_library</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;sensor.other.collision&#39;</span><span class="p">)</span>
<span class="n">collision_sensor</span> <span class="o">=</span> <span class="n">world</span><span class="o">.</span><span class="n">spawn_actor</span><span class="p">(</span><span class="n">collision_bp</span><span class="p">,</span> <span class="n">carla</span><span class="o">.</span><span class="n">Transform</span><span class="p">(),</span> <span class="n">attach_to</span><span class="o">=</span><span class="n">vehicle</span><span class="p">)</span>
<span class="n">collision_sensor</span><span class="o">.</span><span class="n">listen</span><span class="p">(</span><span class="k">lambda</span> <span class="n">event</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Collision with </span><span class="si">{</span><span class="n">event</span><span class="o">.</span><span class="n">other_actor</span><span class="o">.</span><span class="n">type_id</span><span class="si">}</span><span class="s2">, impulse: </span><span class="si">{</span><span class="n">event</span><span class="o">.</span><span class="n">normal_impulse</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">))</span>
</code></pre></div></li>
<li><strong>ROS2集成</strong>：</li>
<li>启用ROS2支持后，传感器数据以特定格式（包含变换和冲量）发送到ROS2话题。</li>
<li>示例话题：<code>/carla/&lt;vehicle_id&gt;/collision</code>。</li>
</ol>
<h4 id="_9">数据输出格式</h4>
<ul>
<li><strong>序列化数据</strong>：
  <div class="highlight"><pre><span></span><code><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;actor&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="nt">&quot;id&quot;</span><span class="p">:</span><span class="w"> </span><span class="err">&lt;ac</span><span class="kc">t</span><span class="err">or_id&gt;</span><span class="p">,</span><span class="w"> </span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="w"> </span><span class="err">&lt;ac</span><span class="kc">t</span><span class="err">or_</span><span class="kc">t</span><span class="err">ype&gt;</span><span class="p">},</span>
<span class="w">  </span><span class="nt">&quot;other_actor&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="nt">&quot;id&quot;</span><span class="p">:</span><span class="w"> </span><span class="err">&lt;o</span><span class="kc">t</span><span class="err">her_ac</span><span class="kc">t</span><span class="err">or_id&gt;</span><span class="p">,</span><span class="w"> </span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="w"> </span><span class="err">&lt;o</span><span class="kc">t</span><span class="err">her_ac</span><span class="kc">t</span><span class="err">or_</span><span class="kc">t</span><span class="err">ype&gt;</span><span class="p">},</span>
<span class="w">  </span><span class="nt">&quot;normal_impulse&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="nt">&quot;x&quot;</span><span class="p">:</span><span class="w"> </span><span class="err">&lt;</span><span class="kc">fl</span><span class="err">oa</span><span class="kc">t</span><span class="err">&gt;</span><span class="p">,</span><span class="w"> </span><span class="nt">&quot;y&quot;</span><span class="p">:</span><span class="w"> </span><span class="err">&lt;</span><span class="kc">fl</span><span class="err">oa</span><span class="kc">t</span><span class="err">&gt;</span><span class="p">,</span><span class="w"> </span><span class="nt">&quot;z&quot;</span><span class="p">:</span><span class="w"> </span><span class="err">&lt;</span><span class="kc">fl</span><span class="err">oa</span><span class="kc">t</span><span class="err">&gt;</span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div></li>
<li><strong>ROS2数据</strong>：包含传感器变换（相对于父Actor）和冲量向量。</li>
</ul>
<h4 id="_10">性能和优化</h4>
<ul>
<li><strong>性能瓶颈</strong>：频繁的碰撞检测和数据序列化可能影响性能，尤其在密集场景中。</li>
<li><strong>优化建议</strong>：</li>
<li>限制碰撞检测的频率（通过调整Tick间隔）。</li>
<li>使用更高效的数据结构（如<code>unordered_set</code>）替代<code>CollisionRegistry</code>的线性搜索。</li>
<li>减少ROS2数据传输的频率，仅在关键碰撞时发送。</li>
</ul>
<h3 id="2-customv2xsensorcpp">2. CustomV2XSensor.cpp</h3>
<h4 id="_11">文件路径</h4>
<p><code>~/carla/Unreal/CarlaUE4/Plugins/Carla/Source/Carla/Sensor/CustomV2XSensor.cpp</code></p>
<h4 id="_12">功能</h4>
<ul>
<li><strong>类</strong>：<code>ACustomV2XSensor</code>（继承自传感器基类，推测为<code>ASensor</code>）。</li>
<li><strong>作用</strong>：模拟V2X（Vehicle-to-Everything）通信，允许车辆间发送和接收自定义消息，基于路径损耗模型（<code>PathLossModel</code>）模拟信号传播。</li>
<li><strong>应用场景</strong>：</li>
<li>车联网仿真：测试V2X协议（如CAM消息）在不同场景下的性能。</li>
<li>协同驾驶：模拟车辆间的信息共享（如位置、速度）。</li>
<li>通信研究：分析信号衰减、干扰和接收功率。</li>
</ul>
<h4 id="_13">代码结构</h4>
<ul>
<li><strong>构造函数</strong>：</li>
<li>初始化传感器，启用每帧Tick。</li>
<li>创建<code>URandomEngine</code>（用于噪声模拟）和<code>PathLossModel</code>对象。</li>
<li><strong>主要方法</strong>：</li>
<li><code>SetOwner(AActor *Owner)</code>：<ul>
<li>管理所有者绑定，维护静态<code>mV2XActorContainer</code>列表。</li>
<li>设置站ID（基于Carla Actor ID）。</li>
<li>将所有者传递给<code>PathLossModel</code>。</li>
</ul>
</li>
<li><code>GetSensorDefinition()</code>：返回V2X传感器蓝图定义（<code>MakeCustomV2XDefinition</code>）。</li>
<li><strong>参数配置</strong>：<ul>
<li><code>Set(const FActorDescription &amp;ActorDescription)</code>：从蓝图设置传感器属性。</li>
<li><code>SetPropagationParams(...)</code>：配置传播参数（发射功率、接收灵敏度、频率、天线增益等）。</li>
<li><code>SetPathLossModel(EPathLossModel)</code>：选择路径损耗模型（如自由空间、城市模型）。</li>
<li><code>SetScenario(EScenario)</code>：设置场景（如城市、公路）。</li>
</ul>
</li>
<li><strong>消息处理</strong>：<ul>
<li><code>PrePhysTick(float DeltaSeconds)</code>：</li>
<li>清除上一周期的消息。</li>
<li>如果消息数据更新（<code>mMessageDataChanged</code>），生成新消息并存储到<code>mActorV2XDataMap</code>。</li>
<li><code>CreateCustomV2XMessage()</code>：生成V2X消息，包含ITS PDU头部（协议版本、消息ID、站ID）和用户定义内容。</li>
<li><code>PostPhysTick(UWorld *World, ELevelTick TickType, float DeltaTime)</code>：</li>
<li>构建其他Actor的发送列表（<code>ActorPowerList</code>）。</li>
<li>调用<code>PathLossModel-&gt;Simulate</code>模拟通信，获取接收功率（<code>ActorPowerMap</code>）。</li>
<li>从<code>mActorV2XDataMap</code>提取接收到的消息，存储到<code>V2XDataList</code>。</li>
<li>通过<code>WriteMessageToV2XData</code>序列化消息并发送。</li>
</ul>
</li>
<li><code>Send(const FString message)</code>：设置用户定义的消息内容，标记为待发送。</li>
<li><strong>数据结构</strong>：</li>
<li><code>mV2XActorContainer</code>：静态列表，存储所有V2X传感器绑定的Actor。</li>
<li><code>mActorV2XDataMap</code>：静态映射，存储Actor与消息/功率对的关联。</li>
<li><code>mV2XData</code>：存储待发送的消息集合。</li>
</ul>
<h4 id="_14">依赖关系</h4>
<ul>
<li><strong>Carla模块</strong>：<code>CarlaEpisode</code>（获取Actor信息）、<code>UCarlaStatics</code>（访问仿真状态）。</li>
<li><strong>Unreal Engine</strong>：<code>AActor</code>、<code>URandomEngine</code>（随机数生成）。</li>
<li><strong>自定义模块</strong>：<code>PathLossModel</code>（信号传播模拟）。</li>
</ul>
<h4 id="_15">使用方法</h4>
<ol>
<li><strong>蓝图配置</strong>：</li>
<li>创建V2X传感器，设置传播参数（如<code>TransmitPower=23.0</code>、<code>ReceiverSensitivity=-90.0</code>）。</li>
<li>附加到车辆Actor，指定场景（如<code>EScenario::Urban</code>）。</li>
<li><strong>Python API示例</strong>：
   <div class="highlight"><pre><span></span><code><span class="kn">import</span> <span class="nn">carla</span>
<span class="n">client</span> <span class="o">=</span> <span class="n">carla</span><span class="o">.</span><span class="n">Client</span><span class="p">(</span><span class="s1">&#39;localhost&#39;</span><span class="p">,</span> <span class="mi">2000</span><span class="p">)</span>
<span class="n">world</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">get_world</span><span class="p">()</span>
<span class="n">blueprint_library</span> <span class="o">=</span> <span class="n">world</span><span class="o">.</span><span class="n">get_blueprint_library</span><span class="p">()</span>
<span class="n">v2x_bp</span> <span class="o">=</span> <span class="n">blueprint_library</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;sensor.other.custom_v2x&#39;</span><span class="p">)</span>
<span class="n">v2x_bp</span><span class="o">.</span><span class="n">set_attribute</span><span class="p">(</span><span class="s1">&#39;transmit_power&#39;</span><span class="p">,</span> <span class="s1">&#39;23.0&#39;</span><span class="p">)</span>
<span class="n">v2x_bp</span><span class="o">.</span><span class="n">set_attribute</span><span class="p">(</span><span class="s1">&#39;receiver_sensitivity&#39;</span><span class="p">,</span> <span class="s1">&#39;-90.0&#39;</span><span class="p">)</span>
<span class="n">v2x_sensor</span> <span class="o">=</span> <span class="n">world</span><span class="o">.</span><span class="n">spawn_actor</span><span class="p">(</span><span class="n">v2x_bp</span><span class="p">,</span> <span class="n">carla</span><span class="o">.</span><span class="n">Transform</span><span class="p">(),</span> <span class="n">attach_to</span><span class="o">=</span><span class="n">vehicle</span><span class="p">)</span>
<span class="n">v2x_sensor</span><span class="o">.</span><span class="n">listen</span><span class="p">(</span><span class="k">lambda</span> <span class="n">data</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Received V2X message: </span><span class="si">{</span><span class="n">data</span><span class="o">.</span><span class="n">message</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">))</span>
</code></pre></div></li>
<li><strong>发送消息</strong>：</li>
<li>通过蓝图或代码调用<code>Send(FString)</code>发送自定义消息。</li>
<li>示例：<code>v2x_sensor-&gt;Send("Hello, V2X!")</code>。</li>
</ol>
<h4 id="_16">数据输出格式</h4>
<ul>
<li><strong>序列化数据</strong>：
  <div class="highlight"><pre><span></span><code><span class="p">[</span>
<span class="w">  </span><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;message&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;&lt;user_defined_string&gt;&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;power&quot;</span><span class="p">:</span><span class="w"> </span><span class="err">&lt;</span><span class="kc">fl</span><span class="err">oa</span><span class="kc">t</span><span class="err">&gt;</span><span class="w"> </span><span class="c1">// 接收功率（dBm）</span>
<span class="w">  </span><span class="p">},</span>
<span class="w">  </span><span class="err">...</span>
<span class="p">]</span>
</code></pre></div></li>
<li><strong>消息结构</strong>（<code>CustomV2XM_t</code>）：
  <div class="highlight"><pre><span></span><code><span class="k">struct</span><span class="w"> </span><span class="nc">CustomV2XM_t</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="n">ITSContainer</span><span class="o">::</span><span class="n">ItsPduHeader_t</span><span class="w"> </span><span class="n">header</span><span class="p">;</span><span class="w"> </span><span class="c1">// 协议版本、消息ID、站ID</span>
<span class="w">  </span><span class="kt">char</span><span class="w"> </span><span class="n">message</span><span class="p">[</span><span class="cm">/* max_length */</span><span class="p">];</span><span class="w">      </span><span class="c1">// 用户定义内容</span>
<span class="p">};</span>
</code></pre></div></li>
</ul>
<h4 id="_17">性能和优化</h4>
<ul>
<li><strong>性能瓶颈</strong>：</li>
<li><code>PathLossModel-&gt;Simulate</code>涉及复杂计算，可能在大量车辆场景中成为瓶颈。</li>
<li>静态<code>mActorV2XDataMap</code>的频繁访问可能导致内存开销。</li>
<li><strong>优化建议</strong>：</li>
<li>限制通信范围（通过<code>filter_distance</code>参数）以减少模拟的Actor数量。</li>
<li>使用异步任务处理信号传播计算。</li>
<li>定期清理<code>mV2XActorContainer</code>以释放无效Actor。</li>
</ul>
<h3 id="3-depthcameracpp">3. DepthCamera.cpp</h3>
<h4 id="_18">文件路径</h4>
<p><code>~/carla/Unreal/CarlaUE4/Plugins/Carla/Source/Carla/Sensor/DepthCamera.cpp</code></p>
<h4 id="_19">功能</h4>
<ul>
<li><strong>类</strong>：<code>ADepthCamera</code>（继承自<code>ASceneCaptureSensor</code>，推测为场景捕获基类）。</li>
<li><strong>作用</strong>：捕获场景的深度信息，生成深度图像，应用后处理效果（如镜头畸变和深度渲染）。</li>
<li><strong>应用场景</strong>：</li>
<li>环境感知：为自动驾驶提供3D场景深度信息。</li>
<li>地图重建：生成点云或深度图。</li>
<li>视觉算法测试：验证深度相关的感知算法。</li>
</ul>
<h4 id="_20">代码结构</h4>
<ul>
<li><strong>构造函数</strong>：</li>
<li>添加后处理材质：<ul>
<li><code>PhysicLensDistortion</code>：模拟镜头畸变。</li>
<li><code>DepthEffectMaterial</code>：渲染深度效果（Linux使用GLSL版本，其他平台使用默认版本）。</li>
</ul>
</li>
<li><strong>主要方法</strong>：</li>
<li><code>GetSensorDefinition()</code>：返回深度相机蓝图定义（类型为<code>camera.depth</code>）。</li>
<li><code>PostPhysTick(UWorld *World, ELevelTick TickType, float DeltaSeconds)</code>：<ul>
<li>使用<code>FPixelReader::SendPixelsInRenderThread</code>在渲染线程中捕获深度图像。</li>
<li>将图像数据（<code>FColor</code>格式）发送到客户端。</li>
</ul>
</li>
<li><strong>数据结构</strong>：依赖Unreal Engine的渲染目标（<code>UTextureRenderTarget2D</code>）存储深度图像。</li>
</ul>
<h4 id="_21">依赖关系</h4>
<ul>
<li><strong>Carla模块</strong>：<code>FPixelReader</code>（像素读取和发送）、<code>UActorBlueprintFunctionLibrary</code>（蓝图定义）。</li>
<li><strong>Unreal Engine</strong>：<code>ASceneCaptureSensor</code>（场景捕获基类）、<code>UTextureRenderTarget2D</code>（渲染目标）。</li>
<li><strong>后处理材质</strong>：<code>PhysicLensDistortion</code>、<code>DepthEffectMaterial</code>（及其GLSL变体）。</li>
</ul>
<h4 id="_22">使用方法</h4>
<ol>
<li><strong>蓝图配置</strong>：</li>
<li>创建深度相机，设置分辨率（如<code>image_size_x=1280</code>、<code>image_size_y=720</code>）和视场角（<code>fov=90</code>）。</li>
<li>附加到车辆或固定位置。</li>
<li><strong>Python API示例</strong>：
   <div class="highlight"><pre><span></span><code><span class="kn">import</span> <span class="nn">carla</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="n">client</span> <span class="o">=</span> <span class="n">carla</span><span class="o">.</span><span class="n">Client</span><span class="p">(</span><span class="s1">&#39;localhost&#39;</span><span class="p">,</span> <span class="mi">2000</span><span class="p">)</span>
<span class="n">world</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">get_world</span><span class="p">()</span>
<span class="n">blueprint_library</span> <span class="o">=</span> <span class="n">world</span><span class="o">.</span><span class="n">get_blueprint_library</span><span class="p">()</span>
<span class="n">depth_bp</span> <span class="o">=</span> <span class="n">blueprint_library</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;sensor.camera.depth&#39;</span><span class="p">)</span>
<span class="n">depth_bp</span><span class="o">.</span><span class="n">set_attribute</span><span class="p">(</span><span class="s1">&#39;image_size_x&#39;</span><span class="p">,</span> <span class="s1">&#39;1280&#39;</span><span class="p">)</span>
<span class="n">depth_bp</span><span class="o">.</span><span class="n">set_attribute</span><span class="p">(</span><span class="s1">&#39;image_size_y&#39;</span><span class="p">,</span> <span class="s1">&#39;720&#39;</span><span class="p">)</span>
<span class="n">depth_camera</span> <span class="o">=</span> <span class="n">world</span><span class="o">.</span><span class="n">spawn_actor</span><span class="p">(</span><span class="n">depth_bp</span><span class="p">,</span> <span class="n">carla</span><span class="o">.</span><span class="n">Transform</span><span class="p">(</span><span class="n">carla</span><span class="o">.</span><span class="n">Location</span><span class="p">(</span><span class="n">z</span><span class="o">=</span><span class="mf">2.5</span><span class="p">)),</span> <span class="n">attach_to</span><span class="o">=</span><span class="n">vehicle</span><span class="p">)</span>
<span class="n">depth_camera</span><span class="o">.</span><span class="n">listen</span><span class="p">(</span><span class="k">lambda</span> <span class="n">image</span><span class="p">:</span> <span class="n">process_depth_image</span><span class="p">(</span><span class="n">image</span><span class="p">))</span>
<span class="k">def</span> <span class="nf">process_depth_image</span><span class="p">(</span><span class="n">image</span><span class="p">):</span>
    <span class="n">array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">frombuffer</span><span class="p">(</span><span class="n">image</span><span class="o">.</span><span class="n">raw_data</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">image</span><span class="o">.</span><span class="n">height</span><span class="p">,</span> <span class="n">image</span><span class="o">.</span><span class="n">width</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Depth image shape: </span><span class="si">{</span><span class="n">array</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div></li>
<li><strong>数据处理</strong>：</li>
<li>深度图像以<code>FColor</code>格式传输，通常需要转换为浮点深度值（参考Carla文档）。</li>
</ol>
<h4 id="_23">数据输出格式</h4>
<ul>
<li><strong>序列化数据</strong>：RGBA图像（<code>FColor</code>格式），其中颜色编码深度值。</li>
<li><strong>示例</strong>：
  <div class="highlight"><pre><span></span><code><span class="c1"># 深度值解码（参考Carla文档）</span>
<span class="k">def</span> <span class="nf">depth_to_array</span><span class="p">(</span><span class="n">image</span><span class="p">):</span>
    <span class="n">array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">frombuffer</span><span class="p">(</span><span class="n">image</span><span class="o">.</span><span class="n">raw_data</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">image</span><span class="o">.</span><span class="n">height</span><span class="p">,</span> <span class="n">image</span><span class="o">.</span><span class="n">width</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
    <span class="n">depth</span> <span class="o">=</span> <span class="p">(</span><span class="n">array</span><span class="p">[:,</span> <span class="p">:,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">array</span><span class="p">[:,</span> <span class="p">:,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="mi">256</span> <span class="o">+</span> <span class="n">array</span><span class="p">[:,</span> <span class="p">:,</span> <span class="mi">2</span><span class="p">]</span> <span class="o">*</span> <span class="mi">256</span> <span class="o">*</span> <span class="mi">256</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="mi">256</span> <span class="o">*</span> <span class="mi">256</span> <span class="o">*</span> <span class="mi">256</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">depth</span> <span class="o">*</span> <span class="mi">1000</span>  <span class="c1"># 转换为米</span>
</code></pre></div></li>
</ul>
<h4 id="_24">性能和优化</h4>
<ul>
<li><strong>性能瓶颈</strong>：高分辨率深度图像的渲染和传输可能导致延迟。</li>
<li><strong>优化建议</strong>：</li>
<li>降低分辨率或视场角以减少渲染开销。</li>
<li>使用异步渲染队列处理深度图像。</li>
<li>仅在必要时启用后处理效果。</li>
</ul>
<h3 id="4-dvscameracpp">4. DVSCamera.cpp</h3>
<h4 id="_25">文件路径</h4>
<p><code>~/carla/Unreal/CarlaUE4/Plugins/Carla/Source/Carla/Sensor/DVSCamera.cpp</code></p>
<h4 id="_26">功能</h4>
<ul>
<li><strong>类</strong>：<code>ADVSCamera</code>（继承自<code>ASceneCaptureSensor</code>，推测为场景捕获基类）。</li>
<li><strong>作用</strong>：模拟动态视觉传感器（DVS），通过检测像素亮度变化生成事件流，适用于高速运动或低光照场景。</li>
<li><strong>应用场景</strong>：</li>
<li>动态场景感知：跟踪快速移动的物体。</li>
<li>低功耗视觉：模拟生物启发的视觉系统。</li>
<li>神经形态计算：为Spiking Neural Networks提供输入数据。</li>
</ul>
<h4 id="_27">代码结构</h4>
<ul>
<li><strong>构造函数</strong>：</li>
<li>启用后处理效果，添加<code>PhysicLensDistortion</code>材质。</li>
<li>创建<code>URandomEngine</code>用于噪声模拟。</li>
<li><strong>主要方法</strong>：</li>
<li><code>GetSensorDefinition()</code>：<ul>
<li>返回DVS相机蓝图定义，包含可配置参数：</li>
<li><code>positive_threshold</code>（正阈值，默认0.3）。</li>
<li><code>negative_threshold</code>（负阈值，默认0.3）。</li>
<li><code>sigma_positive_threshold</code>（正噪声标准差，默认0.0）。</li>
<li><code>sigma_negative_threshold</code>（负噪声标准差，默认0.0）。</li>
<li><code>refractory_period_ns</code>（不应期，纳秒，默认0）。</li>
<li><code>use_log</code>（是否使用对数变换，默认true）。</li>
<li><code>log_eps</code>（对数变换epsilon，默认0.001）。</li>
</ul>
</li>
<li><code>Set(const FActorDescription &amp;Description)</code>：从蓝图提取参数，存储到<code>config</code>结构。</li>
<li><code>PostPhysTick(UWorld *World, ELevelTick TickType, float DeltaTime)</code>：<ul>
<li>捕获RGB图像（<code>ReadPixels</code>）。</li>
<li>转换为灰度（<code>ImageToGray</code>）或对数灰度（<code>ImageToLogGray</code>）。</li>
<li>运行DVS仿真（<code>Simulation</code>），生成事件流。</li>
<li>序列化事件并通过数据流或ROS2发送。</li>
</ul>
</li>
<li><code>ImageToGray(const TArray&lt;FColor&gt; &amp;image)</code>：<ul>
<li>将RGB图像转换为灰度（<code>0.2989*R + 0.5870*G + 0.1140*B</code>）。</li>
<li>存储到<code>last_image</code>。</li>
</ul>
</li>
<li><code>ImageToLogGray(const TArray&lt;FColor&gt; &amp;image)</code>：<ul>
<li>将RGB图像转换为对数灰度（<code>log(eps + I/255.0)</code>）。</li>
<li>存储到<code>last_image</code>。</li>
</ul>
</li>
<li><code>Simulation(float DeltaTime)</code>：<ul>
<li>初始化：设置参考图像（<code>ref_values</code>）、前一图像（<code>prev_image</code>）和时间戳（<code>last_event_timestamp</code>）。</li>
<li>遍历像素，检测亮度变化（阈值<code>1e-6</code>）。</li>
<li>根据变化方向（正/负）选择阈值（<code>Cp</code>/<code>Cm</code>），添加噪声（<code>sigma_Cp</code>/<code>sigma_Cm</code>）。</li>
<li>生成事件（<code>DVSEvent</code>：x、y、时间戳、极性），考虑不应期（<code>refractory_period_ns</code>）。</li>
<li>按时间戳排序事件。</li>
</ul>
</li>
<li><strong>数据结构</strong>：</li>
<li><code>last_image</code>：当前灰度图像。</li>
<li><code>prev_image</code>：前一帧灰度图像。</li>
<li><code>ref_values</code>：参考亮度值。</li>
<li><code>last_event_timestamp</code>：每个像素的最近事件时间戳。</li>
<li><code>DVSEventArray</code>：事件列表（x、y、t、polarity）。</li>
</ul>
<h4 id="_28">依赖关系</h4>
<ul>
<li><strong>Carla模块</strong>：<code>CarlaEpisode</code>（获取时间）、<code>UActorBlueprintFunctionLibrary</code>（蓝图参数）、<code>ROS2</code>（可选）。</li>
<li><strong>Unreal Engine</strong>：<code>ASceneCaptureSensor</code>、<code>URandomEngine</code>、<code>UTextureRenderTarget2D</code>。</li>
<li><strong>外部库</strong>：<code>carla::Buffer</code>、<code>carla::BufferView</code>（数据序列化）。</li>
</ul>
<h4 id="_29">使用方法</h4>
<ol>
<li><strong>蓝图配置</strong>：</li>
<li>创建DVS相机，设置分辨率和参数（如<code>positive_threshold=0.3</code>、<code>refractory_period_ns=1000</code>）。</li>
<li>附加到车辆或固定位置。</li>
<li><strong>Python API示例</strong>：
   <div class="highlight"><pre><span></span><code><span class="kn">import</span> <span class="nn">carla</span>
<span class="n">client</span> <span class="o">=</span> <span class="n">carla</span><span class="o">.</span><span class="n">Client</span><span class="p">(</span><span class="s1">&#39;localhost&#39;</span><span class="p">,</span> <span class="mi">2000</span><span class="p">)</span>
<span class="n">world</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">get_world</span><span class="p">()</span>
<span class="n">blueprint_library</span> <span class="o">=</span> <span class="n">world</span><span class="o">.</span><span class="n">get_blueprint_library</span><span class="p">()</span>
<span class="n">dvs_bp</span> <span class="o">=</span> <span class="n">blueprint_library</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;sensor.camera.dvs&#39;</span><span class="p">)</span>
<span class="n">dvs_bp</span><span class="o">.</span><span class="n">set_attribute</span><span class="p">(</span><span class="s1">&#39;positive_threshold&#39;</span><span class="p">,</span> <span class="s1">&#39;0.3&#39;</span><span class="p">)</span>
<span class="n">dvs_bp</span><span class="o">.</span><span class="n">set_attribute</span><span class="p">(</span><span class="s1">&#39;use_log&#39;</span><span class="p">,</span> <span class="s1">&#39;True&#39;</span><span class="p">)</span>
<span class="n">dvs_camera</span> <span class="o">=</span> <span class="n">world</span><span class="o">.</span><span class="n">spawn_actor</span><span class="p">(</span><span class="n">dvs_bp</span><span class="p">,</span> <span class="n">carla</span><span class="o">.</span><span class="n">Transform</span><span class="p">(</span><span class="n">carla</span><span class="o">.</span><span class="n">Location</span><span class="p">(</span><span class="n">z</span><span class="o">=</span><span class="mf">2.5</span><span class="p">)),</span> <span class="n">attach_to</span><span class="o">=</span><span class="n">vehicle</span><span class="p">)</span>
<span class="n">dvs_camera</span><span class="o">.</span><span class="n">listen</span><span class="p">(</span><span class="k">lambda</span> <span class="n">data</span><span class="p">:</span> <span class="n">process_dvs_events</span><span class="p">(</span><span class="n">data</span><span class="p">))</span>
<span class="k">def</span> <span class="nf">process_dvs_events</span><span class="p">(</span><span class="n">data</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">event</span> <span class="ow">in</span> <span class="n">data</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;DVS event: x=</span><span class="si">{</span><span class="n">event</span><span class="o">.</span><span class="n">x</span><span class="si">}</span><span class="s2">, y=</span><span class="si">{</span><span class="n">event</span><span class="o">.</span><span class="n">y</span><span class="si">}</span><span class="s2">, t=</span><span class="si">{</span><span class="n">event</span><span class="o">.</span><span class="n">t</span><span class="si">}</span><span class="s2">, polarity=</span><span class="si">{</span><span class="n">event</span><span class="o">.</span><span class="n">polarity</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div></li>
<li><strong>ROS2集成</strong>：</li>
<li>事件流以<code>DVSEvent</code>格式发送到ROS2话题（如<code>/carla/&lt;vehicle_id&gt;/dvs</code>）。</li>
<li>包含相机分辨率、视场角和变换信息。</li>
</ol>
<h4 id="_30">数据输出格式</h4>
<ul>
<li><strong>序列化数据</strong>：
  <div class="highlight"><pre><span></span><code><span class="p">[</span>
<span class="w">  </span><span class="p">{</span><span class="nt">&quot;x&quot;</span><span class="p">:</span><span class="w"> </span><span class="err">&lt;i</span><span class="kc">nt</span><span class="err">&gt;</span><span class="p">,</span><span class="w"> </span><span class="nt">&quot;y&quot;</span><span class="p">:</span><span class="w"> </span><span class="err">&lt;i</span><span class="kc">nt</span><span class="err">&gt;</span><span class="p">,</span><span class="w"> </span><span class="nt">&quot;t&quot;</span><span class="p">:</span><span class="w"> </span><span class="err">&lt;ui</span><span class="kc">nt</span><span class="mi">64</span><span class="err">&gt;</span><span class="p">,</span><span class="w"> </span><span class="nt">&quot;polarity&quot;</span><span class="p">:</span><span class="w"> </span><span class="err">&lt;bool&gt;</span><span class="p">},</span>
<span class="w">  </span><span class="err">...</span>
<span class="p">]</span>
</code></pre></div></li>
<li><strong>ROS2数据</strong>：包含事件流、相机参数（分辨率、视场角）和变换。</li>
</ul>
<h4 id="_31">性能和优化</h4>
<ul>
<li><strong>性能瓶颈</strong>：</li>
<li>像素级亮度变化检测和事件生成对高分辨率图像开销大。</li>
<li>事件排序（<code>std::sort</code>）在高事件率时可能影响性能。</li>
<li><strong>优化建议</strong>：</li>
<li>降低分辨率或限制视场角。</li>
<li>使用并行处理（如多线程）加速像素遍历。</li>
<li>调整<code>refractory_period_ns</code>以减少事件生成率。</li>
</ul>
<h2 id="_32">集成和扩展</h2>
<h3 id="_33">依赖关系总结</h3>
<ul>
<li><strong>共同依赖</strong>：</li>
<li>Unreal Engine：<code>AActor</code>、<code>UPrimitiveComponent</code>、<code>UTextureRenderTarget2D</code>。</li>
<li>Carla框架：<code>CarlaEpisode</code>、<code>ActorRegistry</code>、<code>UCarlaStatics</code>、<code>FPixelReader</code>。</li>
<li><strong>特定依赖</strong>：</li>
<li><code>CollisionSensor</code>：<code>FCarlaServer</code>、<code>ROS2</code>。</li>
<li><code>CustomV2XSensor</code>：<code>PathLossModel</code>。</li>
<li><code>DepthCamera</code>：后处理材质（<code>PhysicLensDistortion</code>、<code>DepthEffectMaterial</code>）。</li>
<li><code>DVSCamera</code>：<code>URandomEngine</code>、<code>carla::Buffer</code>。</li>
</ul>
<h3 id="_34">扩展建议</h3>
<ul>
<li><strong>自定义传感器</strong>：</li>
<li>继承<code>ASensor</code>或<code>ASceneCaptureSensor</code>，实现<code>GetSensorDefinition</code>和数据处理逻辑。</li>
<li>参考<code>CustomV2XSensor</code>的路径损耗模型集成方式。</li>
<li><strong>新功能</strong>：</li>
<li>为<code>CollisionSensor</code>添加碰撞强度过滤。</li>
<li>为<code>CustomV2XSensor</code>支持更多消息类型（如DENM）。</li>
<li>为<code>DepthCamera</code>添加自定义后处理效果。</li>
<li>为<code>DVSCamera</code>支持彩色事件生成。</li>
</ul>
              
            </div>
          </div><footer>

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
          
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
        <span>
          <a href="https://github.com/OpenHUTB/doc" class="fa fa-github" style="color: #fcfcfc"> GitHub</a>
        </span>
    
    
    
  </span>
</div>
    <script src="../../js/jquery-3.6.0.min.js"></script>
    <script>var base_url = "../..";</script>
    <script src="../../js/theme_extra.js"></script>
    <script src="../../js/theme.js"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.4/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
      <script src="https://cdn.rawgit.com/knsv/mermaid/6.0.0/dist/mermaid.min.js"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/raphael/2.2.7/raphael.min.js"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/underscore.js/1.8.3/underscore-min.js"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/js-sequence-diagrams/1.0.6/sequence-diagram-min.js"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/flowchart/1.6.5/flowchart.min.js"></script>
      <script src="../../js/umlconvert.js"></script>
      <script src="../../search/main.js"></script>
    <script>
        jQuery(function () {
            SphinxRtdTheme.Navigation.enable(true);
        });
    </script>

</body>
</html>

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
      <link rel="shortcut icon" href="../img/favicon.ico" />
    <title>ROS 1 的 ROS 桥接安装 - 人车模拟</title>
    <link rel="stylesheet" href="../css/theme.css" />
    <link rel="stylesheet" href="../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" />
        <link href="../extra.css" rel="stylesheet" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "ROS 1 \u7684 ROS \u6865\u63a5\u5b89\u88c5";
        var mkdocs_page_input_path = "ros_installation_ros1.md";
        var mkdocs_page_url = null;
      </script>
    
    <!--[if lt IE 9]>
      <script src="../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
      <script>hljs.highlightAll();</script> 
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href=".." class="icon icon-home"> 人车模拟
        </a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="..">首页</a>
                </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="..">人车模拟</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href=".." class="icon icon-home" aria-label="Docs"></a></li>
      <li class="breadcrumb-item active">ROS 1 的 ROS 桥接安装</li>
    <li class="wy-breadcrumbs-aside">
          <a href="https://github.com/OpenHUTB/doc/edit/master/docs/ros_installation_ros1.md" class="icon icon-github"> Edit on GitHub</a>
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <h1 id="ros-1-ros">ROS 1 的 ROS 桥接安装</h1>
<p>本节介绍如何在 Linux 上安装 ROS 桥接器以与 ROS 1 一起使用。您将找到先决条件、安装步骤、如何运行基本包以确保一切正常运行以及运行测试的命令。</p>
<ul>
<li><a href="#before-you-begin"><strong>在你开始之前</strong></a><ul>
<li><a href="#ros-bridge-installation"><strong>ROS 桥安装</strong></a><ul>
<li><a href="#a-using-the-debian-repository">A. 使用 Debian 存储库</a></li>
<li><a href="#b-using-the-source-repository">B. 使用源存储库</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#run-the-ros-bridge"><strong>运行 ROS 桥</strong></a></li>
<li><a href="#testing"><strong>测试</strong></a></li>
</ul>
<div class="admonition 重要">
<p class="admonition-title">重要</p>
<p>ROS 桥尚未在 Windows 中进行测试。</p>
</div>
<hr />
<h2 id="_1">在你开始之前</h2>
<p>在使用 ROS 桥之前，您需要满足以下软件要求：</p>
<ul>
<li>根据您的操作系统安装 ROS：<ul>
<li><a href="https://wiki.ros.org/melodic/Installation/Ubuntu"><strong>ROS Melodic</strong></a> — 适用于 Ubuntu 18.04 (Bionic)</li>
<li><a href="https://wiki.ros.org/noetic#Installation"><strong>ROS Noetic</strong></a> — 适用于 20.04 (Focal)</li>
</ul>
</li>
<li>根据您的需要，可能需要额外的 ROS 软件包。强烈建议使用 <a href="https://wiki.ros.org/rviz">rviz</a> 来可视化 ROS 数据。</li>
<li>Carla 0.9.7 或更高版本 — 以前的版本与 ROS 桥不兼容。按照 <a href="https://carla.readthedocs.io/en/latest/start_quickstart/">快速启动安装</a> 或针对 <a href="https://carla.readthedocs.io/en/latest/build_linux/">Linux</a> 进行构建。建议尽可能将 ROS 桥接版本与 Carla 版本匹配。</li>
</ul>
<hr />
<h2 id="ros">ROS 桥安装</h2>
<p>有两个选项可用于安装 ROS 桥接器：</p>
<ul>
<li>通过 Debian 存储库中的 <strong>apt</strong> 工具进行安装。仅适用于 Ubuntu 18.04。</li>
<li>从 GitHub 上的源存储库克隆。</li>
</ul>
<p>下面详细介绍这两种方法。</p>
<div class="admonition 重要">
<p class="admonition-title">重要</p>
<p>要安装 0.9.10 之前的 ROS 桥接器版本，您可以在 <a href="https://carla.readthedocs.io/en/0.9.10/ros_installation/">此处</a> 找到旧版本的 Carla 文档中的说明。使用窗口右下角的面板更改为适当版本的文档。 <img alt="docs_version_panel" src="../img/docs_version_panel.jpg" /></p>
</div>
<h3 id="a-debian">A. 使用 Debian 存储库</h3>
<div class="admonition 笔记">
<p class="admonition-title">笔记</p>
<p>此安装方法仅适用于 Ubuntu 18.04。对于其他支持的发行版，请参阅 <a href="#b-using-the-source-repository">B 部分：使用源存储库</a> 。</p>
</div>
<p><strong>1.</strong> 在您的系统中设置 Debian 存储库：
<div class="highlight"><pre><span></span><code><span class="w">    </span>sudo<span class="w"> </span>apt-key<span class="w"> </span>adv<span class="w"> </span>--keyserver<span class="w"> </span>keyserver.ubuntu.com<span class="w"> </span>--recv-keys<span class="w"> </span>1AF1527DE64CB8D9
<span class="w">    </span>sudo<span class="w"> </span>add-apt-repository<span class="w"> </span><span class="s2">&quot;deb [arch=amd64] http://dist.carla.org/carla </span><span class="k">$(</span>lsb_release<span class="w"> </span>-sc<span class="k">)</span><span class="s2"> main&quot;</span>
</code></pre></div></p>
<p><strong>2.</strong> 安装ROS桥：</p>
<blockquote>
<ul>
<li>
<p>最新版本：
<div class="highlight"><pre><span></span><code>sudo<span class="w"> </span>apt-get<span class="w"> </span>update<span class="w"> </span><span class="c1"># 更新Debian包索引</span>
sudo<span class="w"> </span>apt-get<span class="w"> </span>install<span class="w"> </span>carla-ros-bridge<span class="w"> </span><span class="c1"># 安装最新的ROS桥接版本，或更新当前的安装</span>
</code></pre></div></p>
</li>
<li>
<p>通过向命令添加版本标签来安装特定版本：
<div class="highlight"><pre><span></span><code>apt-cache<span class="w"> </span>madison<span class="w"> </span>carla-ros-bridge<span class="w"> </span><span class="c1"># 列出ROS桥接的可用版本</span>
sudo<span class="w"> </span>apt-get<span class="w"> </span>install<span class="w"> </span>carla-ros-bridge<span class="o">=</span><span class="m">0</span>.9.10-1<span class="w"> </span><span class="c1"># 在这种情况下，“0.9.10”指的是ROS桥接版本，“1”指的是Debian版本</span>
</code></pre></div></p>
</li>
</ul>
</blockquote>
<p><strong>3.</strong> 检查 <code>/opt/</code> 文件夹中ROS桥是否已安装成功。</p>
<h3 id="b">B. 使用源存储库</h3>
<p><strong>1.</strong> 创建catkin工作区：
<div class="highlight"><pre><span></span><code>mkdir<span class="w"> </span>-p<span class="w"> </span>~/carla-ros-bridge/catkin_ws/src
</code></pre></div></p>
<p><strong>2.</strong> 克隆 ROS 桥存储库和子模块：
<div class="highlight"><pre><span></span><code><span class="nb">cd</span><span class="w"> </span>~/carla-ros-bridge
git<span class="w"> </span>clone<span class="w"> </span>--recurse-submodules<span class="w"> </span>https://github.com/carla-simulator/ros-bridge.git<span class="w"> </span>catkin_ws/src/ros-bridge
</code></pre></div></p>
<p><strong>5.</strong> 根据您安装的 ROS 版本设置 ROS 环境：
<div class="highlight"><pre><span></span><code><span class="nb">source</span><span class="w"> </span>/opt/ros/&lt;melodic/noetic&gt;/setup.bash
</code></pre></div>
<strong>6.</strong> 安装所需的 ros 依赖项：
<div class="highlight"><pre><span></span><code><span class="nb">cd</span><span class="w"> </span>catkin_ws
rosdep<span class="w"> </span>update
rosdep<span class="w"> </span>install<span class="w"> </span>--from-paths<span class="w"> </span>src<span class="w"> </span>--ignore-src<span class="w"> </span>-r
</code></pre></div></p>
<p><strong>7.</strong> 构建ROS桥：
<div class="highlight"><pre><span></span><code>catkin<span class="w"> </span>build<span class="w">   </span><span class="c1"># alternatively catkin_make</span>
</code></pre></div></p>
<hr />
<h2 id="ros_1">运行 ROS 桥</h2>
<p><strong>1.</strong> 按照安装 Carla 时使用的安装方法启动 Carla 服务器：
<div class="highlight"><pre><span></span><code><span class="c1"># 包版本在 carla 根文件夹</span>
./CarlaUE4.sh

<span class="c1"># Debian 安装在 `opt/carla-simulator/`</span>
./CarlaUE4.sh

<span class="c1"># 从 carla 根文件夹中的源版本构建</span>
make<span class="w"> </span>launch
</code></pre></div></p>
<p><strong>2.</strong> 将正确的 Carla 模块添加到您的 Python 路径：</p>
<div class="highlight"><pre><span></span><code><span class="nb">export</span><span class="w"> </span><span class="nv">CARLA_ROOT</span><span class="o">=</span>&lt;path-to-carla&gt;
<span class="nb">export</span><span class="w"> </span><span class="nv">PYTHONPATH</span><span class="o">=</span><span class="nv">$PYTHONPATH</span>:<span class="nv">$CARLA_ROOT</span>/PythonAPI/carla/dist/carla-&lt;carla_version_and_arch&gt;.egg:<span class="nv">$CARLA_ROOT</span>/PythonAPI/carla
</code></pre></div>
<p><strong>3.</strong> 根据 ROS 桥的安装方法添加 ROS 桥工作空间的源路径。每次您想要运行 ROS 桥接器时，都应该在每个终端中完成此操作：</p>
<div class="highlight"><pre><span></span><code><span class="c1"># 用于 debian 安装 ROS 桥。根据已安装的 ROS 版本更改命令。</span>
<span class="nb">source</span><span class="w"> </span>/opt/carla-ros-bridge/&lt;melodic/noetic&gt;/setup.bash

<span class="c1"># 为 GitHub 库安装 ROS 桥</span>
<span class="nb">source</span><span class="w"> </span>~/carla-ros-bridge/catkin_ws/devel/setup.bash
</code></pre></div>
<div class="admonition 重要">
<p class="admonition-title">重要</p>
<p>源路径可以永久设置，但在使用其他工作区时可能会导致冲突。</p>
</div>
<p><strong>4.</strong> 启动 ROS 桥。使用任何可用的不同启动文件来检查安装：</p>
<div class="highlight"><pre><span></span><code><span class="c1"># 选项1:启动 ros 桥 </span>
roslaunch<span class="w"> </span>carla_ros_bridge<span class="w"> </span>carla_ros_bridge.launch

<span class="c1"># 选项2:启动ros桥和一个示例自主车辆</span>
roslaunch<span class="w"> </span>carla_ros_bridge<span class="w"> </span>carla_ros_bridge_with_example_ego_vehicle.launch
</code></pre></div>
<div class="admonition 笔记">
<p class="admonition-title">笔记</p>
<p>如果您收到错误：<code>ImportError: no module named CARLA</code> 则缺少 CARLA Python API 的路径。apt 安装会自动设置路径，但其他安装可能会丢失该路径。</p>
<p>您需要将适当的<code>.egg</code>文件添加到您的 Python 路径中。您将在<code>/PythonAPI/</code>或<code>/PythonAPI/dist/</code>中找到该文件，具体取决于 Carla 安装。使用与您安装的 Python 版本相对应的<code>.egg</code>文件，使用文件的完整路径执行以下命令：</p>
<p><code>export PYTHONPATH=$PYTHONPATH:path/to/carla/PythonAPI/&lt;your_egg_file&gt;</code></p>
<p>建议通过将前一行添加到<code>.bashrc</code>文件中来永久设置此变量。</p>
<p>要检查 Carla 库是否可以正确导入，请运行以下命令并等待成功消息：</p>
<pre><code>    python3 -c 'import carla;print("Success")' # python3

    or

    python -c 'import carla;print("Success")' # python2
</code></pre>
</div>
<hr />
<h2 id="_2">测试</h2>
<p>使用 catkin 执行测试：</p>
<p><strong>1.</strong> 构建包：</p>
<div class="highlight"><pre><span></span><code>catkin_make<span class="w"> </span>-DCATKIN_ENABLE_TESTING<span class="o">=</span><span class="m">0</span>
</code></pre></div>
<p><strong>2.</strong> 运行测试：</p>
<div class="highlight"><pre><span></span><code>rostest<span class="w"> </span>carla_ros_bridge<span class="w"> </span>ros_bridge_client.test
</code></pre></div>
<hr />
              
            </div>
          </div><footer>

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
          
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
        <span>
          <a href="https://github.com/OpenHUTB/doc" class="fa fa-github" style="color: #fcfcfc"> GitHub</a>
        </span>
    
    
    
  </span>
</div>
    <script src="../js/jquery-3.6.0.min.js"></script>
    <script>var base_url = "..";</script>
    <script src="../js/theme_extra.js"></script>
    <script src="../js/theme.js"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.4/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
      <script src="https://cdn.rawgit.com/knsv/mermaid/6.0.0/dist/mermaid.min.js"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/raphael/2.2.7/raphael.min.js"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/underscore.js/1.8.3/underscore-min.js"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/js-sequence-diagrams/1.0.6/sequence-diagram-min.js"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/flowchart/1.6.5/flowchart.min.js"></script>
      <script src="../js/umlconvert.js"></script>
      <script src="../search/main.js"></script>
    <script>
        jQuery(function () {
            SphinxRtdTheme.Navigation.enable(true);
        });
    </script>

</body>
</html>
